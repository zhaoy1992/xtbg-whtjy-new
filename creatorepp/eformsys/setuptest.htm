<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>测试eform的安装情况</title>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
		<meta name="ProgId" content="VisualStudio.HTML">
		<meta name="Originator" content="Microsoft Visual Studio .NET 7.1">
		<script src="fceform/js/fcpub.js"></script>
	</head>
	<body>
		<FONT face="宋体"></FONT><STRONG>测试eform的安装情况:</STRONG>
		<div id="div1"></div>
		<script>
			
			function test1() {
				var s="a";
				try {
					s = isSpace(s) ;
				}catch(e){
					div1.innerText += "无法读到fceform/js/fcpub.js文件的内容,可能是找不到fceform/js/fcpub.js文件,也可能是因为汉字的问题而使fcpub.js文件的格式不正确\r\n"  ;
					return false ;
				}
				return true ;
			}
			function test2() {
				if(fcpubdata.dotnetVersion == ""){
				
					var sRet = SendHttp(location.protocol+'//'+location.host + fcpubdata.servletPath + '/HelloWorld'+fcpubdata.dotnetVersion,'');
					if(sRet != "HelloWorld\r\n"){
						div1.innerText += "无法调用到后台的servlet,\r\n";
						return false;
					}
				}
				return true ;
			}
			function test3() {
				
					var sRet = SqlToField("select biaoshi from FC_MAXBH where biaoshi='BIL'");
					
					if(sRet != "BIL"){
						div1.innerText += "无法调用到后台的数据库,\r\n"+sRet+"\r\n";
						return false;
					}
				return true ;
			}
			
			
			if(	test1() && test2() && test3()){
				div1.innerText += "安装配置正确!" ;
			};
		</script>
	</body>
</html>
