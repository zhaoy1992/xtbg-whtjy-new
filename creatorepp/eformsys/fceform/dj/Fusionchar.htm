<%@ page contentType="text/html; charset=GBK" %><%@page import="com.chinacreator.security.AccessControl"%>
<%@page import="com.frameworkset.common.poolman.DBUtil"%>

<%AccessControl accesscontroler = AccessControl.getInstance();
  if(!accesscontroler.checkAccess(request, response)){
  		return;
  }
  String appPath = "app_"+accesscontroler.getCurrentSystemID();
  String appId = accesscontroler.getCurrentSystemID();
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
		<meta http-equiv="Content-Type" content="text/html; charset=GBK">		
		<STYLE> .userData{behavior:url(#default#userData);}
		
	@import url(../css/dj.css); 

	</STYLE>		
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>
		<script src="../../fceform/js/ccpub.js" defer></script>
		<script src="../../fceform/js/ccapp_pub.js" defer></script>		
		<script src="../../../eformsys/gaeditor/js/gaeditor.js" defer></script>
		<script src="../../../iWebOffice2006/js/iWebOffice2006.js" defer></script>
		<script langage="javascript">
			//根据应用确定样式的目录
			var stylePath = "../../../ccapp/<%=appPath%>/"; 
			var mylink = document.createElement("link");
			mylink.setAttribute("type","text/css");
			mylink.setAttribute("rel","stylesheet");
			var _my_namespace_js = "<script src='"+stylePath+"js/namespace.js"+"'></"+"script>";
			window.document.write(_my_namespace_js);		
		</script>
		<%@ include file="../../../iWebOffice2006/js/iWebOffice2006Event.jsp"%>
	</HEAD>
	<body bgcolor="#ffffff" onload="uf_open();">
		<iframe id="_newframe" name="_newframe" height="0" width="0"></iframe>
		<script>
var w_xMax = screen.width;   
var w_yMax = screen.height;
var w_modelw = w_xMax*7/8;
var w_modelh = w_yMax*4/5;	
var w_dialogLeft  =(w_xMax - w_modelw)/2;
var w_dialogTop = (w_yMax - w_modelh)/4;	
window.dialogHeight=w_modelh+'px';
window.dialogWidth=w_modelw+'px';
window.dialogLeft=w_dialogLeft+'px';
window.dialogTop= w_dialogTop+'px';
		
var pubdjbh=parent.sOpenDjNo;
var pubEdit=false;   			
var pubDataSet=null;
var pubRequest=parent.oRequest;
var pubEformEnterStatus="OK"; 
pub_djhtm();
</script>
<script>
mylink.setAttribute('href',stylePath+'css/creatorBlue/allStyle.css');
var myhead = document.getElementsByTagName('head')[0];
myhead.appendChild(mylink);
fcpubdata.creatorStyle='creatorBlue';
</script>
<script src='../../fceform/js/fcopendj.js'></script>
<script defer src='../../fceform/js/fcsavedj.js'></script>
<script src='../../fceform/js/fcselfuse.js'></script>
<script src='../../fceform/js/fcbasecont.js'></script>
<script defer src='../../fceform/js/fcother.js'></script>

<script defer src='../../fceform/js/selectdate.js'></script>
<script src='../../fceform/../fceformext/js/userfunc.js'></script>
<script src='../../fceform/js/fcdate.js'></script>
<link href=../../fceform/css/tabstyle.css type=text/css rel=stylesheet>

<link type='text/css' rel='stylesheet' href='../../fceform/css/Button.css'/>
<link type='text/css' rel='stylesheet' href='../../fceform/css/TextStyle.css'/>
<script>
var pubDataSet=parent.sOpenDjNo;
var returnvalue;
var fatherwindow;
function getMainUrl(){
		
		var obj=pubDataSet[0] ;
   	 	var vid = obj.fusion_id;
   	 	//alert(obj.style.width);
   	 	var divw = obj.f_w;  // flash width
		divw = obj.style.width.replace('px','');
		//divw==''?obj.style.width.replace('px',''):divw;
		var divh = obj.f_h;  // flash high
		divh = obj.style.height.replace('px','');
		//divh==''?obj.style.height.replace('px',''):divh;
		var divtop = obj.style.top.replace('px','');
		//obj.f_top==''?obj.style.top.replace('px',''):obj.f_top;
		var divleft = obj.style.left.replace('px','');
		//obj.f_left==''?obj.style.left.replace('px',''):obj.f_left;
		var flocation = obj.style.position;
		
   	 	vid = vid == undefined?'':vid;
   	 	
   	 	
   	 	var rv = returnvalue;
   	 	rv = rv==undefined?'':rv;
   		
   		var fusiontype = '';
   		var index = rv.indexOf('$');
   		if(index!=-1){
   			var substr = rv.substring(0,index);
   			var subindex = substr.indexOf("_");
   			if(subindex!=-1){
   				fusiontype = substr.substring(0,subindex);
   			}else{
   				fusiontype = substr;
   			}
   			
   		}
   		
   		fatherwindow = parent.dialogArguments[11];
   		return '../../../FusionCharts/main.jsp?fusionid='+vid+'&flocation='+flocation+'&divleft='+divleft+'&divtop='+divtop+'&divh='+divh+'&divw='+divw+'&fusiontype='+fusiontype;
}

function uf_ok() {
   var obj=pubDataSet[0] ;
   obj.returnValue = returnvalue;
 
  // alert( '点击OK的值为：'+obj.returnValue );
   if(obj.returnValue== undefined || IsSpace(obj.returnValue)==true){
   var answer = confirm("你未设置图表属性，你确定保存吗？\n 确定：不设置图片信息  \n 取消：继续设置图片信息")
	   if(!answer){
	   		return;
	   }
   }
   
   if(IsSpace(_get_FieldValue('f_id'))==true){
   	alert('控件ID必须填写');
   	return;
   }
   
	obj.fusion_id= _get_FieldValue('f_preffix')+''+_get_FieldValue('f_id');
	obj.f_id = _get_FieldValue('f_id');
	obj.f_preffix = _get_FieldValue('f_preffix');
	obj.f_location = _get_FieldValue('f_location');
   
    obj.f_top=_get_FieldValue('f_top');
    obj.style.top = obj.f_top;
	obj.f_w=_get_FieldValue('f_w');
	obj.style.width = obj.f_w;
	obj.f_h=_get_FieldValue('f_h');
	obj.style.height = obj.f_h;
	obj.f_left=_get_FieldValue('f_left');
	obj.style.left = obj.f_left;
   	//window.close();
}

function _set_Value(objField,fid){
	objField = document.getElementById(fid).value;
}

function _get_FieldValue(_id){
	
	return  mainframes.mainiframe.document.getElementById(_id).value;
}

function _set_FieldValue(_id,_value){
	document.getElementById(_id).value = _value;
}

function uf_open(){ 
    var obj=pubDataSet[0];
    
    returnvalue = obj.returnValue;
    
    var mainurl = getMainUrl();
	mainframes.location.href=mainurl;
	
	/*
    if(IsSpace(obj.f_location)==true){
    	_set_FieldValue('f_location','static');
    }
 	
	  // obj.f_preffix = mainframes.mainiframe.document.getElementById('f_preffix').value;
	 
	return;
  // alert(3);
    _set_Value(obj.f_preffix,'f_preffix');
    
    _set_Value(obj.f_id,'f_id');
    //定位未设初始值 
    if(obj.f_location==undefined){
    	_set_FieldValue('f_location','static');
    }else{
    	_set_FieldValue('f_location',obj.f_location);
    }
    
    if(_get_FieldValue('f_location')== "static") {
		document.getElementById('f_left').disabled = true;
		document.getElementById('f_top').disabled = true;
	}else{
		document.getElementById('f_left').disabled = false;
		document.getElementById('t_top').disabled = false ;
	}
	
	_set_Value(obj.f_top,'f_top');
	_set_Value(obj.f_w,'f_w');
	_set_Value(obj.f_h,'f_h');
	_set_Value(obj.f_left,'f_left');
     */
}

function onclose(){

	if(IsSpace(returnvalue)==true){
    	alert("警告：你未配置图表展示属性，该控件可能不能正常显示!!");
	}
}

function closeme(){

	if(IsSpace(returnvalue)==true){
	var answer = confirm("你未设置图表属性，你确定保存吗？\n 确定：不设置图片信息  \n 取消：继续设置图片信息")
		   if(!answer){
		   		return;
		   }
	}else{
		alert('你设置的属性是:'+returnvalue);
	}
	window.close();
}
</script>
<!-- 下面隐藏div应该是要删除的字段 -->
<div style="display:none">

<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js&#13;&#10;fcdate.js" creatorType="20090611101511078958" type="ZW" contxml="<root><label><id>label2</id><id>label7</id><id>label5</id><id>label9</id><id>label8</id><id>label6</id></label><combobox><id>f_location</id></combobox><div><id>f_div2</id><id>div1</id></div><button><id>f_save</id><id>f_cancel</id><id>button4</id></button><text><id>f_id</id><id>f_left</id><id>f_w</id><id>f_h</id><id>f_top</id><id>f_preffix</id></text></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:9;radio:0;listbox:0;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:2;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:2;DsMain_field:0;a:0;button:4;text:6;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;creatorSubForm:0;creator_div:0;ExtGrid:0;ExtUpload:0;ExtTree:0;Fusionchar:0" creator_pagination version="1.0" idtype="1" creator_csslib OtherSave="否" isfile="否" posheight poswidth postop posleft isprotect="是" islog="否" creator_office_isBindForm="否" creator_showAlert="是" creator_elementAuthoritySwitch="否" hasWorkflowButton="否" creator_remark entertype="修改" window="当前窗口" BLONclose="UnLoadWebOffice();onclose();" BLONopen="setAuthority();uf_open();" keyfield codeheader="BBB" creatorStyle="creatorBlue" mkbh caption="fusion属性页" dj_sn="20100114093313562312" testDbName billtaborder="<root><taborder>f_save</taborder><taborder>f_cancel</taborder><taborder>f_location</taborder><taborder>button4</taborder><taborder>f_id</taborder><taborder>f_left</taborder><taborder>f_w</taborder><taborder>f_h</taborder><taborder>f_top</taborder><taborder>f_preffix</taborder></root>" toolbar="不带工具栏">&nbsp; 
<DIV id=f_div2 style="BORDER-RIGHT: black 1px solid; BORDER-TOP: black 1px solid; LEFT: 1px; OVERFLOW: auto; BORDER-LEFT: black 1px solid; WIDTH: 505px; BORDER-BOTTOM: black 1px solid; POSITION: absolute; TOP: 1px; HEIGHT: 421px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() controltype="div" NotBg="否">
<DIV id=div1 style="BORDER-RIGHT: black 1px solid; BORDER-TOP: black 1px solid; LEFT: 75px; OVERFLOW: auto; BORDER-LEFT: black 1px solid; WIDTH: 345px; BORDER-BOTTOM: black 1px solid; POSITION: absolute; TOP: 36px; HEIGHT: 245px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() controltype="div" NotBg="否">
<DIV id=label2 style="LEFT: 23px; WIDTH: 65px; POSITION: absolute; TOP: 24px; HEIGHT: 15px; TEXT-ALIGN: right" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label2">控件ID：</DIV><INPUT id=f_id style="LEFT: 205px; WIDTH: 108px; POSITION: absolute; TOP: 20px; HEIGHT: 20px" onmovestart=moveStart() size=19 controltype="text"><SELECT id=f_location style="LEFT: 107px; WIDTH: 66px; POSITION: absolute; TOP: 62px; HEIGHT: 25px" onmovestart=moveStart() controltype="combobox" check="1" tempvalue="static&#13;&#10;absolute"  sql temptext="绝对&#13;&#10;静态"  sqltrans onchange='bill_onclick("uf_changeVal()")'><OPTION value='absolute' selected>绝对</OPTION><OPTION value='static'>静态</OPTION></SELECT><INPUT id=f_left style="LEFT: 43px; WIDTH: 43px; POSITION: absolute; TOP: 91px; HEIGHT: 20px" onmovestart=moveStart() size=5 controltype="text"> 
<DIV id=label7 style="LEFT: 169px; WIDTH: 29px; POSITION: absolute; TOP: 94px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label7">宽：</DIV><BUTTON id=button4 style="LEFT: 184px; WIDTH: 122px; POSITION: absolute; TOP: 145px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" >图形属性配置</BUTTON> 
<DIV id=label5 style="LEFT: 16px; WIDTH: 33px; POSITION: absolute; TOP: 95px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label5">左：</DIV>
<DIV id=label9 style="LEFT: 34px; WIDTH: 65px; POSITION: absolute; TOP: 64px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label4">定位方式：</DIV>
<DIV id=label8 style="LEFT: 243px; WIDTH: 31px; POSITION: absolute; TOP: 91px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label8">高：</DIV>
<DIV id=label6 style="LEFT: 94px; WIDTH: 20px; POSITION: absolute; TOP: 95px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" NotBg="否" value="label6">上：</DIV></DIV></DIV></DIV>
<BUTTON id=FCButton1 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 226px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 368px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON id=FCButton2 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 310px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 368px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" onclick='bill_onclick("closeme()")'></BUTTON>
</div>
<iframe src="" width="100%" height="100%" name="mainframes" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="yes"></iframe>
</body>
</html>