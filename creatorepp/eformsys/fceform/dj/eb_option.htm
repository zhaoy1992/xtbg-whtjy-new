<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
		<STYLE> .userData{behavior:url(#default#userData);}
	@import url(../css/dj.css); 
	</STYLE>
		<script src="../js/fcpub.js"></script>
		<script src="../js/fcrundj.js"></script>
		<script src="../js/tabpane.js"></script>		
	</HEAD>
	<body background="../images/ef_run_background.gif" onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>
var pubdjbh=parent.sOpenDjNo;
var pubEdit=false;   			
var pubDataSet=null;
var pubRequest=parent.oRequest;
var pubEformEnterStatus="OK"; 
pub_djhtm();
		</script>
<script>var obj
function uf_open() {
	obj = pubDataSet[1];
	txtRows.value = obj.rows;
	txtCols.value = obj.cols;
	txtRowHeight.value = obj.rowHeight;
	txtColWidth.value = obj.colWidth;
	txtFirstColWidth.value = obj.firstColWidth;
	SetCheckBoxValue(chkFromDb,obj.fromdb);
	SetCheckBoxValue(chkShiftF,obj.shiftf);
}
function uf_ok() {
	obj.rows=txtRows.value;
	obj.cols=txtCols.value;
	obj.rowHeight=txtRowHeight.value;
	obj.colWidth = txtColWidth.value;
	obj.firstColWidth = txtFirstColWidth.value;
	obj.fromdb = chkFromDb.value;
	obj.shiftf = chkShiftF.value;
	
	var oXmlConfig = SetDomFile("../ereport/econfig.xml");
	oXmlConfig.documentElement.childNodes(1).childNodes(0).text = obj.fromdb;
	oXmlConfig.documentElement.childNodes(1).childNodes(1).text = obj.rows;
	oXmlConfig.documentElement.childNodes(1).childNodes(2).text = obj.cols;
	oXmlConfig.documentElement.childNodes(1).childNodes(3).text = obj.rowHeight;
	oXmlConfig.documentElement.childNodes(1).childNodes(4).text = obj.colWidth;
	oXmlConfig.documentElement.childNodes(1).childNodes(5).text = obj.firstColWidth;
	if(oXmlConfig.documentElement.childNodes(1).childNodes.length > 6 ){
		oXmlConfig.documentElement.childNodes(1).childNodes(6).text = obj.shiftf;
	}else{
		var oX = SetDom("<shiftf>"+obj.shiftf+"</shiftf>");
		oXmlConfig.documentElement.childNodes(1).appendChild(oX.documentElement);
	}
	uf_savexml(oXmlConfig);
	window.close();
	
}
function uf_savexml(oXml){
		//alert(oXml.documentElement.xml);
	var sContent ='<?xml version="1.0" encoding="GB2312" ?>'+ oXml.documentElement.xml ;
	sContent = "<![CDATA["+sContent +"]]>";
	var sXml = "<no>djsn</no><no>"+sContent+"</no><no>ereport/econfig.xml</no>"+"<No>"+fcpubdata.Path+"</No>";
	var ret=savedesignhtml(sXml);
	return ret;	
}</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script defer src='../js/selectdate.js'></script><script src='../js/design.js'></script><script src='../../fceformext/js/userfunc.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/shape.css'  /><script src='../js/webfxlayout.js'></script><link id='luna-tab-style-sheet' type='text/css' rel='stylesheet' href='../css/luna/tab.css'  /><link type='text/css' rel='stylesheet' href='../css/Button.css'/><script >document.styleSheets[0].addRule(".xpSpin","behavior: url(../htc/NumEdit.htc)",0);</script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;design.js&#13;&#10;~userfunc.js" toolbar="不带工具栏" dj_sn="eb_option" type="PR" caption="报表选项" mkbh codeheader="BBB" keyfield center="居中" window="有模式窗口" entertype="修改" posleft postop poswidth="300" posheight="330" isfile="否" OtherSave="否" idtype="1" billtaborder="<root><taborder>button1</taborder><taborder>button2</taborder><taborder>txtRows</taborder><taborder>txtCols</taborder><taborder>txtRowHeight</taborder><taborder>txtColWidth</taborder><taborder>chkFromDb</taborder><taborder>txtFirstColWidth</taborder><taborder>chkShiftF</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:2;label:35;radio:1;listbox:0;textarea:0;combobox:7;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:3;tab:1;div:0;DsMain_field:0;a:0;button:2;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:14;excel:0;tree:0" contxml="<root><checkbox><id>chkFromDb</id><id>chkShiftF</id></checkbox><label><id>label7</id><id>label27</id><id>label28</id><id>label29</id><id>label30</id><id>label31</id><id>label32</id><id>label33</id><id>label34</id><id>Label4</id><id>label35</id></label><shape><id>shape3</id></shape><tab><id>tab1</id></tab><button><id>button1</id><id>button2</id></button><spin><id>txtRows</id><id>txtCols</id><id>txtRowHeight</id><id>txtColWidth</id><id>txtFirstColWidth</id></spin></root>" BLONopen="uf_open()"><DIV class=tab-pane id=tab1 style="LEFT: 3px; WIDTH: 282px; POSITION: absolute; TOP: 1px; HEIGHT: 263px" IsHideTitle="undefined" showtype="luna">
<DIV class=tab-page style="WIDTH: 282px; HEIGHT: 245px">
<H2 class=tab>常规</H2><?xml:namespace prefix = v /><v:RoundRect id=shape3 style="DISPLAY: block; LEFT: 4px; WIDTH: 242px; POSITION: absolute; TOP: 13px; HEIGHT: 89px" controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect>&nbsp; 
<DIV id=label7 style="FONT-SIZE: 10pt; LEFT: 11px; WIDTH: 12px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 32px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">行数</DIV>
<DIV class=xpSpin id=txtRows style="LEFT: 39px; WIDTH: 46px; POSITION: absolute; TOP: 26px; HEIGHT: 22px; align: undefined" align="undefined ParentPos='相对' " value="" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="26px" left="39px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>&nbsp; 
<DIV id=label27 style="FONT-SIZE: 10pt; LEFT: 135px; WIDTH: 12px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 32px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">列数</DIV>
<DIV class=xpSpin id=txtCols style="LEFT: 160px; WIDTH: 46px; POSITION: absolute; TOP: 27px; HEIGHT: 22px; align: undefined" align="undefined ParentPos='相对' " value="" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="27px" left="160px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV id=label28 style="FONT-SIZE: 10pt; LEFT: 11px; WIDTH: 12px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 55px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">行高</DIV>
<DIV class=xpSpin id=txtRowHeight style="LEFT: 39px; WIDTH: 46px; POSITION: absolute; TOP: 49px; HEIGHT: 22px; align: undefined" align="undefined ParentPos='相对' " value="" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="49px" left="39px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV id=label29 style="FONT-SIZE: 10pt; LEFT: 135px; WIDTH: 12px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 54px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">列宽</DIV>
<DIV class=xpSpin id=txtColWidth style="LEFT: 160px; WIDTH: 46px; POSITION: absolute; TOP: 48px; HEIGHT: 22px; align: undefined" align="undefined ParentPos='相对' " value="" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="48px" left="160px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV id=label30 style="FONT-SIZE: 10pt; LEFT: 14px; WIDTH: 12px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 79px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">第1列列宽</DIV>
<DIV class=xpSpin id=txtFirstColWidth style="LEFT: 74px; WIDTH: 46px; POSITION: absolute; TOP: 74px; HEIGHT: 22px; align: undefined" align="undefined ParentPos='相对' " value="" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="74px" left="74px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV id=chkFromDb style="LEFT: 9px; WIDTH: 80px; POSITION: absolute; TOP: 173px; HEIGHT: 20px" onmovestart=moveStart() noWrap value="no" controltype="checkbox" NotBg="否" falsevalue="no" truevalue="yes" divtype="checkbox"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>从数据库中读写报表格式文件</SPAN></DIV>
<DIV id=label31 style="LEFT: 88px; WIDTH: 19px; POSITION: absolute; TOP: 53px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV id=label32 style="LEFT: 208px; WIDTH: 19px; POSITION: absolute; TOP: 50px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV id=label33 style="LEFT: 125px; WIDTH: 19px; POSITION: absolute; TOP: 78px; HEIGHT: 15px" onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV id=label34 style="LEFT: 19px; WIDTH: 65px; POSITION: absolute; TOP: 4px; HEIGHT: 15px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() noWrap value="label34" controltype="label" NotBg="否">新建报表时的默认值：</DIV><SPAN id=Label4 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 261px; COLOR: #b2b2b2; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 194px; HEIGHT: 43px; TEXT-ALIGN: left; backgroundColor1: #c0c0c0; textLeft: undefined; textRight: undefined; textCenter: undefined" controltype="label" NotBg="否" align="Left">勾上它报表格式文件将不以单独的文件形式存在,而是保存到数据库的表中,这需要用户自已先定好保存到哪个表中.</SPAN> 
<DIV id=chkShiftF style="LEFT: 8px; WIDTH: 80px; POSITION: absolute; TOP: 107px; HEIGHT: 20px" onmovestart=moveStart() noWrap value="no" controltype="checkbox" NotBg="否" falsevalue="no" truevalue="yes" divtype="checkbox"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>增删行列时自动调整公式中单元格引用</SPAN></DIV><SPAN id=label35 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 253px; COLOR: #b2b2b2; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 129px; HEIGHT: 42px; TEXT-ALIGN: left; backgroundColor1: #c0c0c0; textLeft: undefined; textRight: undefined; textCenter: undefined" controltype="label" NotBg="否" align="Left">例如: B2单元格的公式为 C2+1,如在第二行前插入一行后,B2单元格就变成了B3,此时它的公式就自动调整为 C3+1 </SPAN></DIV></DIV>
<SCRIPT>var tab1 = new WebFXTabPane( document.getElementById( "tab1" ) );</SCRIPT>
<BUTTON id=button1 style="LEFT: 121px; WIDTH: 75px; POSITION: absolute; TOP: 268px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_ok()")'>确定</BUTTON><BUTTON id=button2 style="LEFT: 203px; WIDTH: 75px; POSITION: absolute; TOP: 268px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("CloseBill()")'>取消</BUTTON></DIV></body></html>