<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var O="INSERT";var J=lang["DlgComInsert"];var G=dialogArguments.eWebEditor.document.selection.createRange();G.type=dialogArguments.eWebEditor.document.selection.type;var el;var ep="";var ag="#CCCCCC";var dW="#000000";var kB=true;if(G.type=="Control"){if(G.item(0).tagName=="APPLET"){if(G.item(0).getAttribute("code",2).toLowerCase()=="webeq3.viewercontrol"){O="MODI";J=lang["DlgComModify"];el=G.item(0);ep=bv(el.innerHTML,"eq");ep=ep.replace(/&amp;/,"&");ag=bv(el.innerHTML,"background");dW=bv(el.innerHTML,"foreground");}}}document.write("<title>"+lang["DlgEQ"]+"("+J+")</title>");function bv(html,lQ){var U=new RegExp("<param name=\""+lQ+"\" value=\"(.*?)\">","gi");var kv=U.exec(html);if(kv){return kv[1];}return "";};function I(){lang.as(document);try{d_eq.setMathML(ep);}catch(e){kB=false;}if(kB){v_normal.style.display="";d_bgcolor.value=ag;s_bgcolor.style.backgroundColor=ag;d_forecolor.value=dW;mA.style.backgroundColor=dW;}else{v_install.style.display="";v_installing.innerHTML="<OBJECT CLASSID='clsid:41649A90-B484-11d1-8D75-00C04FC24EE6' CODEBASE='WebEQInstall.cab#Version=3,0,1,6' HEIGHT=1 WIDTH=1></OBJECT>";}at();};function ok(){ag=d_bgcolor.value;dW=d_forecolor.value;ep=d_eq.getPackedMathML();if(!cr(ag)){aF(d_bgcolor,lang["ErrColorBg"]);return;}if(ag==""){ag="#FFFFFF";}if(dW==""){dW="#000000";}dialogArguments.insertHTML("<APPLET codeBase=./ height=100 width=320 code=webeq3.ViewerControl><PARAM NAME=\"foreground\" VALUE=\""+dW+"\"><PARAM NAME=\"background\" VALUE=\""+ag+"\"><PARAM NAME=\"size\" VALUE=\"18\"><PARAM NAME=\"eq\" VALUE=\""+ep+"\"></APPLET>");window.returnValue=null;window.close();}</script> </HEAD> <body onload="I()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table id=v_install border=0 cellpadding=5 cellspacing=10 style="display:none" align=center> <tr><td bgcolor=#ffffff noWrap><span lang=DlgEQInstallAlt></span></td></tr> </table> <div id=v_installing style="display:none"></div> <table border=0 cellpadding=0 cellspacing=0 align=center id=v_normal style="display:none"> <tr> <td colspan=2> <OBJECT CODE='webeq3.editor.InputControl' WIDTH=620 HEIGHT=200 id=d_eq MAYSCRIPT><PARAM NAME=eq VALUE=''></OBJECT> </td> </tr> <tr><td height=8 colspan=2></td></tr> <tr> <td noWrap><span lang=DlgEQBackground></span>:<input type=text id=d_bgcolor size=7 value=""><img border=0 src="../sysimage/rect.gif" width=18 style="cursor:hand" id=s_bgcolor onclick="cq('bgcolor')" align=absmiddle>&nbsp; <span lang=DlgEQForeground></span>:<input type=text id=d_forecolor size=7 value=""><img border=0 src="../sysimage/rect.gif" width=18 style="cursor:hand" id=mA onclick="cq('forecolor')" align=absmiddle></td> <td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel></td> </tr> </table> </td></tr></table> </body> </html> 