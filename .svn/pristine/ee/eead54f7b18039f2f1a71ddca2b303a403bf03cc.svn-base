<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
		<STYLE> .userData{behavior:url(#default#userData);}
	@import url(../css/dj.css); 
	</STYLE>
		<script src="../js/fcpub.js"></script>
		<script src="../js/fcrundj.js"></script>
		<script src="../js/tabpane.js"></script>		
	</HEAD>
	<body background="../images/ef_run_background.gif" onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>
var pubdjbh=parent.sOpenDjNo;
var pubEdit=false;   			
var pubDataSet=null;
var pubRequest=parent.oRequest;
var pubEformEnterStatus="OK"; 
pub_djhtm();
		</script>
<script>var obj ;
function uf_open(){
	//CopyToPub(dataset1.xml);
	//return ;
	obj = pubDataSet[0] ; //t对象
	var sds = obj.e_datasetbak ; 
	if(IsSpace(sds) == false)
		dataset1.OpenXmlData("<root>"+unescape(sds)+"<set><pages>0</pages><fields><field><fieldname>dsname</fieldname><datatype>字符</datatype><displaylabel>名称</displaylabel><size>50</size><precision>0</precision><fieldkind>变量默认值</fieldkind><defaultvalue>'ds'+(mRecordCount+1)</defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dstype</fieldname><datatype>字符</datatype><displaylabel>类型</displaylabel><size>12</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>SQL语句</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>stext</fieldname><datatype>字符</datatype><displaylabel>SQL语句</displaylabel><size>8000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid>%28dataset1.Fields.Field%5B%27dstype%27%5D.Value%3D%3D%27SQL%u8BED%u53E5%27%20%26%26%20%20Valid.checkValue%28%27Require%27%2Cdataset1.Fields.Field%5B%27stext%27%5D.Value%29%3D%3Dfalse%29%20%3F%27SQL%u8BED%u53E5%u4E0D%u80FD%u4E3A%u7A7A%21%27%3A%27%27%20</fieldvalid><tag></tag></field><field><fieldname>dsn</fieldname><datatype>字符</datatype><displaylabel>数据源</displaylabel><size>20</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>param</fieldname><datatype>字符</datatype><displaylabel>参数串</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fieldchn</fieldname><datatype>字符</datatype><displaylabel>字段中文名串</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>beginrow</fieldname><datatype>字符</datatype><displaylabel>开始行</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>endrow</fieldname><datatype>字符</datatype><displaylabel>结束行</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexcols</fieldname><datatype>字符</datatype><displaylabel>索引列</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexsorted</fieldname><datatype>字符</datatype><displaylabel>排序索引字段</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexunique</fieldname><datatype>字符</datatype><displaylabel>唯一的索引字段</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dsin1</fieldname><datatype>字符</datatype><displaylabel>内置数据集结构</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dsin2</fieldname><datatype>字符</datatype><displaylabel>内置数据集记录</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields></set></root>");
	else
		dataset1.Delete();
	e_PropWinOnload();
	
	//设置表格中的下拉列表
	var sHtml = "<tr height='18px'><td></td></tr>";
	var oXml = SetDomFile("../ereport/econfig.xml");
	var ll = oXml.documentElement.childNodes(0).childNodes.length;
	for(var j=0;j<ll;j++){
		sHtml += "<tr height='18px'><td>"+oXml.documentElement.childNodes(0).childNodes(j).getAttribute("name")+"</td></tr>" ;
	}
	var sHtml1 = "<code><format></format><sql1></sql1><xml>"
	var sHtml2 = "</xml><blninput>否</blninput><blnempty>否</blnempty><check>2</check><onclickopen>event.showlist=true</onclickopen></code>"
	grid1.tab.children[0].children[4].cz  = sHtml1+sHtml+sHtml2 ;

}
// e_dataset="name=ds1,sql=&quot;SELECT sarea,sitem,sperson,imoney 
// FROM e_group1 &quot;,type=normal,dsn=sqlserver1,param=&quot;arg1:6;arg2:9&quot;,beginrow=1,endrow=100,cached=0,
// fieldText=中草药1:中草药2,
// indexCols=&quot;aaa,bbb&quot;,indexSorted=true,indexIsUnique=false;
function uf_ok() {
	//dataset1.cont_onDataChange();
	//if(dataset1.Update()==1) return;  //如未离开当前行则要强行更新.	
	if(DsBeforeSave(dataset1,grid1)) return;
	var sDataSource="";
	var isHaveDefault=false;
	
	var sds = new StringBuilder();
	var ll = dataset1.oDom.documentElement.childNodes.length-1 ;
	for(var i=0;i<ll;i++){
		var oo = dataset1.oDom.documentElement.childNodes(i);
		sds.append("name="+oo.childNodes(0).text+",");
		if(oo.childNodes(1).text == "内建数据集"){
			//name=ds2,sql=\"types=\\\"6\\\\t6\\\\t6\\\";data=\\\"\\\\\\\"a\\\\\\\"\\\\t\\\\\\\"c\\\\\\\"\\\\t\\\\\\\"e\\\\\\\"\\\\n\\\\\\\"b\\\\\\\"\\\\t\\\\\\\"d\\\\\\\"\\\\t\\\\\\\"f\\\\\\\"\\\";names=\\\"字段1\\\\t字段2\\\\t字段3\\\"\",type=buildin,cached=0,,indexSorted=false,indexIsUnique=false;
			//var arrTmp=uf_stru(oo.childNodes(11).text);
			var sType="";
			var sName="";
			var sxml = unescape(oo.childNodes(11).text);
			var oXml = SetDom(sxml);
			var l = oXml.documentElement.childNodes.length-1;
			for(var ii=0;ii<l;ii++){
				sType += e_ConvertDataTypeToValue(oXml.documentElement.childNodes(ii).childNodes(1).text);
				sName += oXml.documentElement.childNodes(ii).childNodes(0).text;
				if(ii<l-1){
					sType +="\\\\t";
					sName +="\\\\t";
				}
	
			}
			sType = "\\\""+sType +"\\\"";
			sName = "\\\""+sName +"\\\"";
			
			var s11 = "sql=\"types="+sType+";data=\\\""+uf_data(oo.childNodes(12).text)+"\\\";names="+sName+"\",type=buildin,cached=0,,indexSorted=false,indexIsUnique=false;"
			//s11=RepStr(s11,"\\\\","\\\\\\\\\\\\\\\\");
			sds.append(s11);
		}else if(oo.childNodes(1).text == "自定义数据集"){	
			//sds.append("name=ds1,sql=\"args=\\\"arg1,arg1value;arg2,arg2value\\\";class=\\\"cn.com.fcsoft.report.dataset.XMLDataSetFactory\\\"\",type=self,cached=0,,indexSorted=false,indexIsUnique=false;");
			var s11="";
			var oXml1 = SetDom("<root>"+oo.childNodes(2).text+"</root>");
			if(oXml1.documentElement != null){
				var ll = oXml1.documentElement.childNodes.length;
				for(var i=0;i<ll;i++){
					s11 += oXml1.documentElement.childNodes(i).childNodes(0).text+","+	oXml1.documentElement.childNodes(i).childNodes(1).text;
					if(i<ll-1) s11 += ";" ;
				}	
				s11 = "args=\\\""+s11+"\\\";";
			}
			sds.append("sql=\""+s11+"class=\\\"cn.com.fcsoft.report.dataset.XMLDataSetFactory\\\"\",type=self,cached=0,,indexSorted=false,indexIsUnique=false;");
		
		}else{
			sds.append("sql=\""+oo.childNodes(2).text+"\",type=normal,");
			if(IsSpace(oo.childNodes(3).text) == false) {
				sds.append("dsn="+oo.childNodes(3).text+",");
				sDataSource += oo.childNodes(3).text+",";
			}else{
				isHaveDefault=true;
			}
			if(IsSpace(oo.childNodes(4).text) == false) 
				sds.append("param=\""+oo.childNodes(4).text+"\",");
			if(IsSpace(oo.childNodes(5).text) == false) 
				sds.append("fieldText="+oo.childNodes(5).text+",");
			if(IsSpace(oo.childNodes(6).text) == false) 
				sds.append("beginrow="+oo.childNodes(6).text+",");
			if(IsSpace(oo.childNodes(7).text) == false) 
				sds.append("endrow="+oo.childNodes(7).text+",");
			if(IsSpace(oo.childNodes(8).text) == false) 
				sds.append("indexCols="+oo.childNodes(8).text+",");
				
			sds.append("cached=0,indexSorted="+oo.childNodes(9).text+",indexIsUnique="+oo.childNodes(10).text+";"	);
		}	
	}
	var s1 = sds.toString();
	//alert(s1);
	obj.e_dataset = escape(s1);
	obj.e_datasetbak = escape(dataset1.RecordData);
	//计算数据库连接串
	if(sDataSource != "") sDataSource = sDataSource.substring(0,sDataSource.length-1);
	if(isHaveDefault) sDataSource = "default,"+sDataSource;
	if(sDataSource=="")sDataSource="null"; //防止""空值
	obj.e_datasource = sDataSource;
	//处理其它属性
	
	window.returnValue = "ok";
	
	CloseBill();
	
	//计算内建数据集的结构串
	function uf_stru(s){
		return [sType,sName];
	}
	//计算内建数据集的数据串
	function uf_data(s){
		var sData=new StringBuilder();
		var sxml = unescape(s);
		var oXml = SetDom(sxml);
		var l = oXml.documentElement.childNodes.length-1;
		var ll= oXml.documentElement.childNodes(l).childNodes(1).childNodes.length;
		for(var i=0;i<l;i++){
			for(var j=0;j<ll;j++){
				sData.append("\\\\\\\""+oXml.documentElement.childNodes(i).childNodes(j).text+"\\\\\\\"");
				if(j<ll-1) sData.append("\\\\t");
			}
			if(i<l-1) sData.append("\\\\n");
		}
		return sData.toString();
	}	
}
//设置数据集的其它属性
function uf_other() {
	if(grid1.tab.rows.length <= 1 ) return;
	if(dataset1.Fields.Field['dstype'].Value=="内建数据集"){
		var o = [dataset1.Fields.Field["dsin1"].Value,dataset1.Fields.Field["dsin2"].Value];
		var oRet = DjOpen("eb_dataset2",o,"展现","有模式窗口","直接","编辑内置数据集");
		if(IsSpace(oRet)==false){
			dataset1.bEdit = true;
			dataset1.Fields.Field["dsin1"].Value=oRet[0];
			dataset1.Fields.Field["dsin2"].Value=oRet[1];
			dataset1.Update("不检查");
		}
	}else if(dataset1.Fields.Field['dstype'].Value=="自定义数据集"){
		var sxml1 = dataset1.Fields.Field["stext"].Value;
		sxml1 = Trim(sxml1);
		//检查是否是合法的xml串
		if(sxml1.substring(0,6) == "select") sxml1 = "";
		if(sxml1.substring(0,3) != "<tr") sxml1 = "";

		var oRet = DjOpen("eb_dataset3",sxml1,"展现","有模式窗口","直接","自定义数据集");
		if(typeof oRet != "undefined"){
			dataset1.bEdit = true;
			dataset1.Fields.Field["stext"].Value=oRet;
			dataset1.Update("不检查");
			grid1.hide();
			dataset1.fset_cont();
		}
		
	}else{
		var o = new Object();
		o.stext = dataset1.Fields.Field["stext"].Value ;
		o.param = dataset1.Fields.Field["param"].Value ;
		o.fieldchn = dataset1.Fields.Field["fieldchn"].Value ;
		o.beginrow = dataset1.Fields.Field["beginrow"].Value ;
		o.endrow = dataset1.Fields.Field["endrow"].Value ;
		o.indexcols = dataset1.Fields.Field["indexcols"].Value ;
		o.indexsorted = dataset1.Fields.Field["indexsorted"].Value ;
		o.indexunique = dataset1.Fields.Field["indexunique"].Value ;
		var oRet = DjOpen("eb_dataset1",o,"展现","有模式窗口","直接","设置数据集的其它属性");
		if(IsSpace(oRet) == false){
			dataset1.bEdit = true;
			dataset1.Fields.Field["stext"].Value = oRet.stext  ;
			dataset1.Fields.Field["param"].Value = oRet.param  ;
			dataset1.Fields.Field["fieldchn"].Value = oRet.fieldchn  ;
			dataset1.Fields.Field["beginrow"].Value = oRet.beginrow ;
			dataset1.Fields.Field["endrow"].Value = oRet.endrow ;
			dataset1.Fields.Field["indexcols"].Value = oRet.indexcols ;
			dataset1.Fields.Field["indexsorted"].Value = oRet.indexsorted  ;
			dataset1.Fields.Field["indexunique"].Value = oRet.indexunique ;
			dataset1.Update("不检查");
			grid1.hide();
			dataset1.fset_cont();
		}
	}
}
//转内建数据集
function uf_toinds(){
	if(grid1.tab.rows.length <= 1 ) return;
	if(dataset1.Fields.Field["dstype"].Value == "内建数据集" || dataset1.Fields.Field["dstype"].Value == "自定义数据集") return;
	//先运行SQL语句得到结构和记录.
	
	var sXml =  "<sql>" + dataset1.Fields.Field["stext"].Value + "</sql>"+"<pageno>1</pageno><pagesize>-1</pagesize>";
	var sds="";
	var sDataSource = dataset1.Fields.Field["dsn"].Value;
	if(IsSpace(sDataSource) == false){ 
		/*
		<ds dbencoding="GBK" dbtype="sqlserver" drivername="com.newatlanta.jturbo.driver.Driver" 
		encodesql="false" name="sqlserver1" password="" 
		url="jdbc:JTurbo://localhost/mytest/charset=GBK" userid="sa" /> 
		*/
		var oXml = SetDomFile("../ereport/econfig.xml");
		for(var i=0;i<oXml.documentElement.childNodes(0).childNodes.length;i++){
			if(sDataSource == oXml.documentElement.childNodes(0).childNodes(i).getAttribute("name")){
				sds = Xml.documentElement.childNodes(0).childNodes(i).getAttribute("drivername")+";"
					+Xml.documentElement.childNodes(0).childNodes(i).getAttribute("url")+";User ID="
					+Xml.documentElement.childNodes(0).childNodes(i).getAttribute("userid")+";pwd="
					+Xml.documentElement.childNodes(0).childNodes(i).getAttribute("password");
				break;
			}
		}
		
	}
	sXml +=	"<ds>" + sds +"</ds>";
	var sRet = SendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath + "/ebfile"+fcpubdata.dotnetVersion+"?key=ToInDs",sXml);	
	//CopyToPub(sRet);
	
	//生成结构数据集
	var oXml = SetDom(sRet);
	if(oXml.documentElement == null){
		alert("转换失败! 原因是:"+sRet);
		return;	
	}
	var sStru="";
	var oDF=oXml.documentElement.childNodes(oXml.documentElement.childNodes.length-1).childNodes(1);
	var l = oDF.childNodes.length;
	for(var i=0;i<l;i++){
		sStru += "<tr><td>"+oDF.childNodes(i).childNodes(0).text+"</td><td>"+typeTrans(oDF.childNodes(i).childNodes(1).text)+"</td></tr>"
	}
	sStru = "<root>"+sStru+"<set><pages>0</pages><fields><field><fieldname>fieldname</fieldname><datatype>字符</datatype><displaylabel>字段名</displaylabel><size>50</size><precision>0</precision><fieldkind>变量默认值</fieldkind><defaultvalue>'字段'+(mRecordCount+1)</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>datatype</fieldname><datatype>字符</datatype><displaylabel>数据类型</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>字符串</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields></set></root>"
	dataset1.bEdit = true;
	dataset1.Fields.Field["dsin1"].Value = escape(sStru);	
	dataset1.Fields.Field["dsin2"].Value = escape(sRet);
	dataset1.Fields.Field["dstype"].Value = "内建数据集";
	dataset1.Update();
	dataset1.fset_cont();
	alert("转换成功!!");
	//类型名称转换
	function typeTrans(source){
		if(source=="字符")
			return "字符串";
		else
			return source ;
	}
}</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script defer src='../js/selectdate.js'></script><script src='../js/fcdate.js'></script><script src='../../fceformext/js/userfunc.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/Button.css'/><script >document.styleSheets[0].addRule("fc\\:webgrid","behavior: url(../htc/webgrid.htc)",0);</script><script src='../js/fcwebgrid.js'></script><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../htc/dataset.htc)",0);</script><script src='../js/fcdataset.js'></script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fcdate.js&#13;&#10;~userfunc.js" BLONopen="uf_open()" center="居中" contxml="<root><button><id>cmdAdd</id><id>button6</id><id>button7</id><id>cmdDel</id><id>cmdOk</id><id>cmdClose</id></button><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" billtaborder="<root><taborder>grid1</taborder><taborder>cmdAdd</taborder><taborder>button6</taborder><taborder>button7</taborder><taborder>cmdDel</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" dj_sn="eb_dataset" type="PR" caption="数据集设置" mkbh codeheader="BBB" entertype="修改" poswidth="600" posheight="240" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:2;radio:0;listbox:0;textarea:1;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:10;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0" keyfield window="有模式窗口" posleft postop isfile="否" idtype="1" toolbar="不带工具栏" OtherSave="否"><?xml:namespace prefix = fc /><fc:dataset id=dataset1 opensortno="1" temptable="TMP_DATASET1" format="<fields><field><fieldname>dsname</fieldname><datatype>字符</datatype><displaylabel>名称</displaylabel><size>50</size><precision>0</precision><fieldkind>变量默认值</fieldkind><defaultvalue>'ds'+(mRecordCount+1)</defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dstype</fieldname><datatype>字符</datatype><displaylabel>类型</displaylabel><size>12</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>SQL语句</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>stext</fieldname><datatype>字符</datatype><displaylabel>SQL语句</displaylabel><size>8000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>select</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid>%28dataset1.Fields.Field%5B%27dstype%27%5D.Value%3D%3D%27SQL%u8BED%u53E5%27%20%26%26%20%20Valid.checkValue%28%27Require%27%2Cdataset1.Fields.Field%5B%27stext%27%5D.Value%29%3D%3Dfalse%29%20%3F%27SQL%u8BED%u53E5%u4E0D%u80FD%u4E3A%u7A7A%21%27%3A%27%27%20</fieldvalid><tag></tag></field><field><fieldname>dsn</fieldname><datatype>字符</datatype><displaylabel>数据源</displaylabel><size>20</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>param</fieldname><datatype>字符</datatype><displaylabel>参数串</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fieldchn</fieldname><datatype>字符</datatype><displaylabel>字段中文名串</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>beginrow</fieldname><datatype>字符</datatype><displaylabel>开始行</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>endrow</fieldname><datatype>字符</datatype><displaylabel>结束行</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexcols</fieldname><datatype>字符</datatype><displaylabel>索引列</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexsorted</fieldname><datatype>字符</datatype><displaylabel>排序索引字段</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>indexunique</fieldname><datatype>字符</datatype><displaylabel>唯一的索引字段</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dsin1</fieldname><datatype>字符</datatype><displaylabel>内置数据集结构</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>dsin2</fieldname><datatype>字符</datatype><displaylabel>内置数据集记录</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><dsname></dsname><dstype></dstype><stext></stext><dsn></dsn><param></param><fieldchn></fieldchn><beginrow></beginrow><endrow></endrow><indexcols></indexcols><indexsorted></indexsorted><indexunique></indexunique><dsin1></dsin1><dsin2></dsin2></dsid>")' onGetText='bill_ondatasetgettext("<dsid><dsname></dsname><dstype></dstype><stext></stext><dsn></dsn><param></param><fieldchn></fieldchn><beginrow></beginrow><endrow></endrow><indexcols></indexcols><indexsorted></indexsorted><indexunique></indexunique><dsin1></dsin1><dsin2></dsin2></dsid>")' onSetText='bill_ondatasetsettext("<dsid><dsname></dsname><dstype></dstype><stext></stext><dsn></dsn><param></param><fieldchn></fieldchn><beginrow></beginrow><endrow></endrow><indexcols></indexcols><indexsorted></indexsorted><indexunique></indexunique><dsin1></dsin1><dsin2></dsin2></dsid>")'></fc:dataset><fc:webgrid id=grid1 onkeydown='bill_ongridkeydown("<grid1><col></col><col></col><col></col><col></col></grid1>")' ondblclick='bill_ongriddblclick("<grid1><col></col><col></col><col></col><col></col></grid1>")' onclick='bill_ongridclick("<grid1><col></col><col></col><col></col><col></col></grid1>")' bodyrows="-1" bodyrowheight="-1" autosize="否" hideHscroll="否" hideVscroll="否" SetRowHeight="是" canselect="是" autoheight="是" autowidth="是" autoappend="否" readonly="否" visible="是" dataset="dataset1" format="<cols><col><fname>dsname</fname><cname>名称</cname><width>50</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>70</columnwidth><align>left</align></col><col><fname>dstype</fname><cname>类型</cname><width>12</width><dtype>字符</dtype><readonly>选%3Ccode%3E%3Cxml%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3ESQL%u8BED%u53E5%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u5B58%u50A8%u8FC7%u7A0B%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u5185%u5EFA%u6570%u636E%u96C6%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u81EA%u5B9A%u4E49%u6570%u636E%u96C6%3C/td%3E%3C/tr%3E%3C/xml%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Ctemptext%3ESQL%u8BED%u53E5%0D%0A%u5B58%u50A8%u8FC7%u7A0B%0D%0A%u5185%u5EFA%u6570%u636E%u96C6%0D%0A%u81EA%u5B9A%u4E49%u6570%u636E%u96C6%3C/temptext%3E%3C/code%3E</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>80</columnwidth><align>left</align></col><col><fname>stext</fname><cname>SQL语句</cname><width>8000</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>330</columnwidth><align>left</align></col><col><fname>dsn</fname><cname>数据源</cname><width>20</width><dtype>字符</dtype><readonly>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>70</columnwidth><align>left</align></col></cols>" width="568" height="162" top="32" left="7">
<TABLE id=t style="TABLE-LAYOUT: fixed; LEFT: 0px; POSITION: absolute; TOP: 0px; BORDER-COLLAPSE: collapse" cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR class=fcGridFirstRow>
<TD></TD></TR></TBODY></TABLE></fc:webgrid>&nbsp;<BUTTON id=cmdAdd style="LEFT: 8px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick="bill_onclick(&quot;dataset1.Append();dataset1.fset_cont();grid1.EndRowState='edit';&quot;)"></BUTTON><BUTTON id=button6 style="LEFT: 311px; WIDTH: 64px; POSITION: absolute; TOP: 2px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_other()")'>详细属性</BUTTON><BUTTON id=button7 style="LEFT: 380px; WIDTH: 90px; POSITION: absolute; TOP: 2px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_toinds()")'>转内建数据集</BUTTON><BUTTON id=cmdDel style="LEFT: 67px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("dataset1.Delete()")'></BUTTON><BUTTON id=cmdOk style="LEFT: 126px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON id=cmdClose style="LEFT: 185px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("CloseBill()")'></BUTTON></DIV></body></html>