<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<TITLE>"+lang["DlgMap"]+"</TITLE>");var A;var dK;var aE;var cf=null;var iz="";var fu="";var R="";var T="";var du=new Array();var fl=new Array();var jp=new Array();var hp=new Array();var hU=new Array();var ks=new Array();var jh=new Array();var fS=new Array();var aP="";Q=opener.eWebEditor.document.selection.createRange();A=Q.item(0);iz=A.src;fu=A.useMap;R=A.offsetWidth;T=A.offsetHeight;var gN=opener.eWebEditor.document.body.getElementsByTagName("MAP");for(var i=0;i<gN.length;i++){fS[i]=gN[i].name.toUpperCase();if(("#"+fS[i])==fu.toUpperCase()){cf=gN[i];}}aP="<img id='hY' border=0 src='"+iz+"' width='"+R+"' height='"+T+"'>";if(cf){for(var i=0;i<cf.areas.length;i++){du[i]=cf.areas(i).href;fl[i]=cf.areas(i).target;jp[i]=cf.areas(i).coords;var a=jp[i].split(",");hp[i]=parseInt(a[0]);hU[i]=parseInt(a[1]);ks[i]=parseInt(a[2])-hp[i];jh[i]=parseInt(a[3])-hU[i];aP+="<img id='myIMAGE"+i+"' border=1 src='../sysimage/space.gif' style='position:absolute;left:"+hp[i]+"px;top:"+hU[i]+"px;width:"+ks[i]+"px;height:"+jh[i]+"px;zIndex:"+(i+1)+"'>";}}function lG(){mapIframe.document.designMode="On";mapIframe.document.open();mapIframe.document.write("<head><style>body,a,table,td {font-size:9pt;font-family:Verdana, Arial, Helvetica, sans-serif;Color:#000000;}</style></head><body MONOSPACE>");mapIframe.document.body.innerHTML=aP;mapIframe.document.body.contentEditable="true";mapIframe.document.ondblclick=new Function("return of(mapIframe.event);");mapIframe.document.execCommand("2D-Position",true,true);mapIframe.document.execCommand("LiveResize",true,true);mapIframe.document.close();};var gp=new Object();function of(event){var e=event.srcElement;if(e){if((e.tagName=="IMG")&&(e.id!="hY")){var lO=e.id;var gg=parseInt(lO.substr(7));gp.Href=du[gg];gp.Target=fl[gg];var P=showModalDialog("hyperlink.htm?action=other",window,"dialogWidth:0px;dialogHeight:0px;help:no;scroll:no;status:no");if(P){du[gg]=P[0];fl[gg]=P[1];}}}return false;};function nq(){var n=du.length;du[n]="";fl[n]="";mapIframe.document.body.innerHTML+="<img id='myIMAGE"+n+"' border=1 src='../sysimage/space.gif' style='position:absolute;zIndex:"+(n+1)+";width:20;height:20;left:0;top:0'>";mapIframe.scrollBy(0,0);mapIframe.focus();};function kH(){var b=true;var n=0;var s="";while(b){n++;s="AutoMap"+n;if(nL(s)){b=false;}}return s;};function nL(H){H=H.toUpperCase();for(var i=0;i<fS.length;i++){if(fS[i]==H){return false;}}return true;};function ok(){var b=false;for(var i=0;i<du.length;i++){var B=mapIframe.document.getElementById("myIMAGE"+i);if(B){b=true;}}if(b){var html="";for(var i=0;i<du.length;i++){var B=mapIframe.document.getElementById("myIMAGE"+i);if(B){var ki=parseInt(B.style.left);var jZ=parseInt(B.style.top);var mQ=parseInt(B.style.width);var mO=parseInt(B.style.height);var mP=ki+mQ;var mI=jZ+mO;html+="<area shape='rect' href='"+du[i]+"' target='"+fl[i]+"' coords='"+ki+","+jZ+","+mP+","+mI+"'>";}}if(cf){cf.innerHTML=html;}else{fu=kH();A.useMap="#"+fu;opener.appendHTML("<map name='"+fu+"'>"+html+"</map>");}}else{if(cf){cf.outerHTML="";}A.useMap="";}A.width=mapIframe.hY.width;A.height=mapIframe.hY.height;window.returnValue=null;window.close();};function I(){lang.as(document);}</script> </HEAD> <BODY onload="I()"> <table border=0 cellpadding=0 cellspacing=3 align=center width="100%" height="100%"> <tr><td colspan=2 height="100%"><iframe ID="mapIframe" MARGINHEIGHT="1" MARGINWIDTH="1" width="100%" scrolling="yes" height="100%" src="blank.htm"></iframe></td></tr> <tr><td colspan=2 height=5></td></tr> <tr> <td><input type=button class="dlgBtnCommon" value='' id=ou onclick="nq()" lang=DlgMapNew>&nbsp;(<span lang=DlgMapDesc></span>)</td> <td align=right><input type=button class="dlgBtnCommon" value='' id=Ok onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel></td> </tr> </table> <script type="text/javascript">lG();</script> </body> </html> 