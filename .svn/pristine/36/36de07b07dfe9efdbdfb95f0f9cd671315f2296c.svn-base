<html> <head> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<TITLE>"+lang["DlgAnchor"]+"</TITLE>");var oRange;var ba;var aC;var ed="";oRange=dialogArguments.eWebEditor.document.selection.createRange();ba=dialogArguments.eWebEditor.document.selection.type;if(ba=="Control"){aC=oRange(0).parentNode;}else{aC=oRange.parentElement();}if(aC.tagName.toUpperCase()=="A"){if(aC.href.toUpperCase()==""){ed=aC.name;jE(aC);}}function I(){d_anchor.value=ed;ib();lang.as(document);at();};function ib(){d_allanchor.options.length=0;var aS=dialogArguments.eWebEditor.document.body.getElementsByTagName("A");for(i=0;i<aS.length;i++){if(aS[i].href.toUpperCase()==""){d_allanchor.options[d_allanchor.options.length]=new Option(aS[i].name,aS[i].name);}}};function jV(H){var aS=dialogArguments.eWebEditor.document.body.getElementsByTagName("A");for(i=0;i<aS.length;i++){if(aS[i].href.toUpperCase()==""){if(aS[i].name==H){return aS[i];}}}return null;};function ok(){var ed=bs(d_anchor.value);if(ed==""){aF(d_anchor,lang["DlgAnchorNoName"]);return;}oRange=dialogArguments.eWebEditor.document.selection.createRange();ba=dialogArguments.eWebEditor.document.selection.type;if(ba=="Control"){aC=oRange(0).parentNode;}else{aC=oRange.parentElement();}var kA=false;if(aC.tagName.toUpperCase()=="A"){if(aC.href.toUpperCase()==""){aC.name=ed;kA=true;}}if(!kA){var html="";if(ba=="Control"){oRange(0).outerHTML="<a id=eWebEditor_TempElement_Anchor name="+ed+">"+oRange(0).outerHTML+"</a>";}else{oRange.pasteHTML("<a id=eWebEditor_TempElement_Anchor name="+ed+">"+oRange.htmlText+"</a>");}var au=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Anchor");if(config.ShowBorder!="0"){au.runtimeStyle.borderBottom="1px dashed #000000";}au.removeAttribute("id");}window.returnValue=null;window.close();};function lH(){var eC=d_allanchor.selectedIndex;if(eC<0){alert(lang["DlgAnchorNoSelected"]);return;}var G=jV(d_allanchor.options[eC].value);if(G){jE(G);}};function lv(){var eC=d_allanchor.selectedIndex;if(eC<0){alert(lang["DlgAnchorNoSelected"]);return;}var G=jV(d_allanchor.options[eC].value);if(G){G.outerHTML=G.innerHTML;d_allanchor.options[eC]=null;}};function jE(G){var K=dialogArguments.eWebEditor.document.body.createTextRange();K.moveToElementText(G);K.select();}</script> </head> <body onload="I()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <TABLE CELLSPACING="0" cellpadding="5" border="0" align=center> <TR valign="top"> <TD noWrap align="left"> <span lang=DlgAnchorName></span>:<br> <INPUT TYPE=TEXT SIZE=20 id="d_anchor" style="width:150px;"><br> <span lang=DlgAnchorOther></span>:<br> <select id="d_allanchor" size=8 style="width:150px;" onchange="d_anchor.value=this.options[this.selectedIndex].value;"></select> </td> <td noWrap height="100%"> <table border=0 cellpadding=0 cellspacing=0 height="100%"> <tr> <td height="50%" valign=top> <input type=button class="dlgBtnCommon" style="margin-top:15px" name="oB" onClick="ok()" value="" lang=DlgBtnOK><br> <input type=button class="dlgBtnCommon" style="margin-top:5px" name="mt" onClick="window.close()" value="" lang=DlgBtnCancel><br> </td> </tr> <tr> <td height="50%" valign=bottom> <input type=button class="dlgBtnCommon" name="ot" onClick="lH()" value="" lang=DlgBtnGoto><br> <input type=button class="dlgBtnCommon" style="margin-top:5px" name="ox" onClick="lv()" value="" lang=DlgBtnDel><br> </td> </tr> </table> </td> </tr> </table> </td></tr></table> </body> </html>