<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
		<STYLE> .userData{behavior:url(#default#userData);}
	@import url(../css/dj.css); 
	</STYLE>
		<script src="../js/fcpub.js"></script>
		<script src="../js/fcrundj.js"></script>
		<script src="../js/tabpane.js"></script>		
	</HEAD>
	<body background="../images/ef_run_background.gif" onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>
var pubdjbh=parent.sOpenDjNo;
var pubEdit=false;   			
var pubDataSet=null;
var pubRequest=parent.oRequest;
var pubEformEnterStatus="OK"; 
pub_djhtm();
		</script>
<script>//拼写listbox控件的显示SQL语句
function uf_sSql(){
	if(fcpubdata.databaseTypeName!="sqlserver" && fcpubdata.databaseTypeName!="oracle"){
		alert("数据库维护只支持sqlserver和oracle两个版本");
		CloseBill();
	}
	var sSql="";
	if(fcpubdata.databaseTypeName=="sqlserver"){
		sSql="select name from sysobjects where xtype='U'and name not like 'tmp_%' order by name ";	
	}
	if(fcpubdata.databaseTypeName=="oracle"){
		sSql="select table_name from user_tables order by table_name";	
	}
	var oOpt=SqlCombo(SKDBListBox1,sSql);
	SKDBListBox1.outerHTML=SelectAddOption(SKDBListBox1,oOpt);
}

//双击List列表，查询出当前数据表中的字段列表
function uf_click(){
	var sval="";  //表名
	var slen=SKDBListBox1.length;
	if(SKDBListBox1.selectedIndex>=0){
		sval=SKDBListBox1.value;
		if(fcpubdata.databaseTypeName=="sqlserver"){
			var sSql="select syscolumns.name as fdname,systypes.name as fdtype,syscolumns.length as fdsize,syscolumns.scale as fddec,case when syscolumns.isnullable=0 then 'NOT NULL' when syscolumns.isnullable=1 then 'NULL' end as isnullable from syscolumns,sysobjects,"
			+"systypes where syscolumns.id=sysobjects.id and  syscolumns.xtype=systypes.xtype and sysobjects.xtype='U' and "
			+"sysobjects.name='"+sval+"' order by syscolumns.colorder";
		}
		if(fcpubdata.databaseTypeName=="oracle"){
			var sSql="select COLUMN_NAME as fdname,DATA_TYPE AS fdtype,decode(DATA_TYPE,'CHAR',DATA_LENGTH,'NCHAR',DATA_LENGTH,'VARCHAR2',DATA_LENGTH,'NVARCHAR2',DATA_LENGTH,'RAW',DATA_LENGTH,DATA_PRECISION) as fdsize,decode(DATA_TYPE,'NUMBER',DATA_SCALE,DATA_PRECISION) as fddec,decode(NULLABLE,'N','NOT NULL','Y','NULL') as isnullable from user_tab_columns where table_name='"+sval+"'";	
		}
		imgdataset1.Open(sSql);
		
		uf_showkey(sval);
	}
}

//点击删除Button，将字段表中当前选中行从数据表中删除
function uf_del(){
	if(SKDBListBox1.selectedIndex<0){
		alert("请选择数据表")
		return;	
	}
	var TAB=SKDBListBox1.value;
	var sSql="";
	var allZD="";
	var iCount=0;
	//双击多选删除字段
	for (i=0;i<imgdataset1.RecordCount;i++){
		if (imgdataset1.oDom.documentElement.childNodes(i).getAttribute("multisel")=='是') {  
	    	var ZD=imgdataset1.oDom.documentElement.childNodes(i).childNodes(0).text;
			if(fcpubdata.databaseTypeName=="sqlserver"){
				var DF=SqlToField("select top 1 name from sysobjects where id=(select syscolumns.cdefault from syscolumns,sysobjects where syscolumns.id=sysobjects.id and sysobjects.name='"+TAB+"' and syscolumns.name='"+ZD+"')")
				if(IsSpace(DF)==false){
					sSql="alter table "+TAB+" drop constraint "+DF+";\n"
				}
				allZD+=ZD+",";
			} 
			if(fcpubdata.databaseTypeName=="oracle"){
				sSql+="alter table "+TAB+" drop column "+ZD+";\n";
				allZD+=ZD+",";	
			}
			iCount++;
		}
	}
	//默认当前行删除字段
	if(iCount<=0){
		allZD=imgdataset1.Fields.Field["fdname"].Value
		if(fcpubdata.databaseTypeName=="sqlserver"){
			var DF=SqlToField("select top 1 name from sysobjects where id=(select syscolumns.cdefault from syscolumns,sysobjects where syscolumns.id=sysobjects.id and sysobjects.name='"+TAB+"' and syscolumns.name='"+allZD+"')")
			if(IsSpace(DF)==false){
			var sSql="alter table "+TAB+" drop constraint "+DF+";\n"
			}
		    sSql+="alter table "+TAB+" drop column "+allZD;	
		}
		if(fcpubdata.databaseTypeName=="oracle"){
			sSql+="alter table "+TAB+" drop column "+allZD;	
		}
	}
	if(allZD.indexOf(",")>0){
		allZD=allZD.substring(0,allZD.length-1);
	}
	var s1=sSql ;
	var arr = s1.split(";");
	var l= arr.length;
	var sXml = ""
	for(var i=0;i<l;i++){
		var s2=Trim(arr[i])
		if(IsSpace(s2)) continue;
		sXml += "<no>" +s2 + "</no>";
	}
	if(confirm("真的要删除'"+allZD+"'字段吗？")){
		var sRet=InsertSqls(sXml);
	}
	if(IsSpace(sRet)){
		uf_click();
	}else{
		alert(sRet);
	}
	
}

//点击新增Button，添加一个新字段到当前表中
function uf_addField(){
	if(SKDBListBox1.selectedIndex<0){
		alert("请选择数据表")
		return;		
	}
	var sval=SKDBListBox1.value;
	var sText=DjOpen('add_column',sval,'展现','有模式窗口','直接','添加字段')
	if(sText=="ok"){
		if(fcpubdata.databaseTypeName=="sqlserver"){
			var sSql="select syscolumns.name as fdname,syscolumns.colorder,systypes.name as fdtype,syscolumns.length as fdsize,syscolumns.scale as fddec,case when syscolumns.isnullable=0 then 'NOT NULL' when syscolumns.isnullable=1 then 'NULL' end as isnullable from syscolumns,sysobjects,"
			+"systypes where syscolumns.id=sysobjects.id and  syscolumns.xtype=systypes.xtype and sysobjects.xtype='U' and "
			+"sysobjects.name='"+sval+"' order by syscolumns.colorder";
		}
		if(fcpubdata.databaseTypeName=="oracle"){
			var sSql="select COLUMN_NAME as fdname,DATA_TYPE AS fdtype,decode(DATA_TYPE,'CHAR',DATA_LENGTH,'NCHAR',DATA_LENGTH,'VARCHAR2',DATA_LENGTH,'NVARCHAR2',DATA_LENGTH,'RAW',DATA_LENGTH,DATA_PRECISION) as fdsize,decode(DATA_TYPE,'NUMBER',DATA_SCALE,DATA_PRECISION) as fddec,decode(NULLABLE,'N','NOT NULL','Y','NULL') as isnullable from user_tab_columns where table_name='"+sval+"'";	
		}
		imgdataset1.Open(sSql);	
	}
		
}

//点击修改Button，修改当前选中字段

function uf_alterField(){
	if(SKDBListBox1.selectedIndex<0){
		alert("请选择数据表")
		return;		
	}
	var sval=SKDBListBox1.value;
	var sFd=imgdataset1.Fields.Field['fdname'].Value;
	var arr=new Array();
	arr[0]=sval;	//表名
	arr[1]=sFd;		//字段名
	var sText=DjOpen('alter_column',arr,'展现','有模式窗口','直接','修改字段')	
	if(sText=="ok"){
		var sSql="";
		if(fcpubdata.databaseTypeName=="sqlserver"){
			sSql="select syscolumns.name as fdname,syscolumns.colorder,systypes.name as fdtype,syscolumns.length as fdsize,syscolumns.scale as fddec,case when syscolumns.isnullable=0 then 'NOT NULL' when syscolumns.isnullable=1 then 'NULL' end as isnullable  from syscolumns,sysobjects,"
			+"systypes where syscolumns.id=sysobjects.id and  syscolumns.xtype=systypes.xtype and sysobjects.xtype='U' and "
			+"sysobjects.name='"+sval+"' order by syscolumns.colorder";
		}
		if(fcpubdata.databaseTypeName=="oracle"){
			sSql="select COLUMN_NAME as fdname,DATA_TYPE AS fdtype,decode(DATA_TYPE,'CHAR',DATA_LENGTH,'NCHAR',DATA_LENGTH,'VARCHAR2',DATA_LENGTH,'NVARCHAR2',DATA_LENGTH,'RAW',DATA_LENGTH,DATA_PRECISION) as fdsize,decode(DATA_TYPE,'NUMBER',DATA_SCALE,DATA_PRECISION) as fddec,decode(NULLABLE,'N','NOT NULL','Y','NULL') as isnullable from user_tab_columns where table_name='"+sval+"'";	
		}
		imgdataset1.Open(sSql);	
	}
}

//设置主键

function uf_setPrimaryKey(){
	if(SKDBListBox1.selectedIndex<0){
		alert("请选择数据表")	
		return;	
	}
	var sval=SKDBListBox1.value;  //表名 
	var sFd=""   //字段名
	var sSql1="";
	if(fcpubdata.databaseTypeName=="sqlserver"){
		sSql1="select name from sysobjects where parent_obj=(select id from sysobjects where sysobjects.name='"+sval+"') and sysobjects.type='K'";
	}
	if(fcpubdata.databaseTypeName=="oracle"){
		sSql1="select constraint_name from user_constraints where table_name='"+sval+"' and constraint_type='P'"	
	}
	var sSql2="";
	var s1=SqlToField(sSql1);
	if(IsSpace(s1)==false){
		sSql2+="alter table "+sval+" drop constraint "+s1+";\n";	
	}
	for(var i=0;i<imgdataset1.RecordCount;i++){
		if(imgdataset1.oDom.documentElement.childNodes(i).getAttribute("multisel")=='是'){
			sFd+=imgdataset1.oDom.documentElement.childNodes(i).childNodes(0).text+",";
		}	
	}
	var len=sFd.length;
	sFd=sFd.substring(0,len-1);
	if(IsSpace(sFd)){
		sFd=imgdataset1.Fields.Field['fdname'].Value	
	}
	if(fcpubdata.databaseTypeName=="sqlserver"){
		sSql2+="alter table "+sval+" add constraint PK_"+sval+" PRIMARY KEY CLUSTERED ("+sFd+")";
	}
	if(fcpubdata.databaseTypeName=="oracle"){
		sSql2+="alter table "+sval+" add primary key ("+sFd+")"	
	}
	var arr = sSql2.split(";");
	var l= arr.length;
	var sXml = ""
	for(var i=0;i<l;i++){
		var s3=Trim(arr[i])
		if(IsSpace(s3)) continue;
		sXml += "<no>" +s3 + "</no>";
	}
	var sRet=InsertSqls(sXml);
	if(IsSpace(sRet)){
		uf_showkey(sval)
		alert("成功！");
	}else{
		alert(sRet);
	}
}
//显示主键到编辑框
function uf_showkey(sval) {
	if(fcpubdata.databaseTypeName=="sqlserver"){
		var sSql3="sp_helpindex '"+sval+"'"
		var str=SelectSql(sSql3,1,1);
		var oXml=SetDom(str);
		var s1="";
		if(oXml.documentElement != null ){
			if(oXml.documentElement.childNodes.length>1){
				s1=oXml.documentElement.childNodes(0).childNodes(2).text;
			}
		}
	}
	if(fcpubdata.databaseTypeName=="oracle"){
		var sSql3="select user_cons_columns.column_name from user_constraints ,user_cons_columns where user_cons_columns.constraint_name=user_constraints.constraint_name and constraint_type='P' and user_constraints.table_name='"+sval+"'";
		var sSql4="select count(user_cons_columns.column_name) from user_constraints ,user_cons_columns where user_cons_columns.constraint_name=user_constraints.constraint_name and constraint_type='P' and user_constraints.table_name='"+sval+"'";
		var slen=SelectSql(sSql4,1,1);//查询出表内有几个字段被设为主键，返回XML串
		var oXml1=SetDom(slen);
		var ilen="";
		var s1="";
		if(oXml1.documentElement != null ){
			if(oXml1.documentElement.childNodes.length>1){
				ilen=oXml1.documentElement.childNodes(0).childNodes(0).text;//返回数字
			}
		}
		if(ilen>0){
			var str=SelectSql(sSql3,1,ilen);
			var oXml=SetDom(str);
			for(var i=0;i<ilen;i++){
				s1+=oXml.documentElement.childNodes(i).childNodes(0).text+",";
			}
			s1=s1.substring(0,s1.length-1);
		}
	}
	FCDBedit1.value=s1;
	
}
//删除表
function uf_dropTab(){
	if(SKDBListBox1.selectedIndex<0){
		alert("请选择数据表")
		return;		
	}
	var TAB=SKDBListBox1.value;  //表名 
	var sSql="drop table "+TAB;
	if(confirm("确定要删除'"+TAB+"'表吗？")==true){
		var s1=InsertSql(sSql);
	}else{
		return;
	}
	if(IsSpace(s1)){
		for (var i=SKDBListBox1.length-1;i>=0;i--){
			if (SKDBListBox1.options(i).selected){
				SKDBListBox1.remove(i)
				SKDBListBox1.selectedIndex=0
			}
		}
		uf_click();
	}else{
		alert(s1);
	}	
}

//新建表
function uf_createTab(){
	var sText=DjOpen('create_tab','','展现','有模式窗口','直接','添加字段')	
	if(IsSpace(sText)==false){
		var i=SKDBListBox1.options.length;
		var oOpt=document.createElement("option")
		oOpt.text=sText.toUpperCase();
		oOpt.value=sText.toUpperCase();
		SKDBListBox1.add(oOpt);
		SKDBListBox1.options(i).selected=true;
		if(fcpubdata.databaseTypeName=="sqlserver"){
			var sSql="select syscolumns.name as fdname,syscolumns.colorder,systypes.name as fdtype,syscolumns.length as fdsize,syscolumns.scale as fddec,case when syscolumns.isnullable=0 then 'NOT NULL' when syscolumns.isnullable=1 then 'NULL' end as isnullable  from syscolumns,sysobjects,"
			+"systypes where syscolumns.id=sysobjects.id and  syscolumns.xtype=systypes.xtype and sysobjects.xtype='U' and "
			+"sysobjects.name='"+sText+"' order by syscolumns.colorder";
		}
		if(fcpubdata.databaseTypeName=="oracle"){
			var sSql="select COLUMN_NAME as fdname,DATA_TYPE AS fdtype,decode(DATA_TYPE,'CHAR',DATA_LENGTH,'NCHAR',DATA_LENGTH,'VARCHAR2',DATA_LENGTH,'NVARCHAR2',DATA_LENGTH,'RAW',DATA_LENGTH,DATA_PRECISION) as fdsize,decode(DATA_TYPE,'NUMBER',DATA_SCALE,DATA_PRECISION) as fddec,decode(NULLABLE,'N','NOT NULL','Y','NULL') as isnullable from user_tab_columns where table_name=UPPER('"+sText+"')";
		}
		FCDBedit1.value=""
		uf_showkey(sText)	
		imgdataset1.Open(sSql);		
	}
}

//删除主键

function uf_delUnique(){
	var sval=SKDBListBox1.value;	//表名
	var sSql="";
	if(fcpubdata.databaseTypeName=="sqlserver"){
		sSql="select name from sysobjects where parent_obj=(select id from sysobjects where sysobjects.name='"+sval+"') and sysobjects.type='k'";
		var oXml=SetDom(SelectSql(sSql,1,1));
	}
	if(fcpubdata.databaseTypeName=="oracle"){
		sSql="select constraint_name from user_constraints where table_name='"+sval+"' and constraint_type='P'"	
		var oXml=SetDom(SelectSql(sSql,1,1))
	}
	if(oXml.documentElement.childNodes.length>1){
		var s1=oXml.documentElement.childNodes(0).childNodes(0).text;
	}else{
		alert("此表内未设主键");
	}	
	if(IsSpace(s1)==false){
		var sSql2="alter table "+sval+" drop constraint "+s1;
		if(confirm("确定要删除'"+sval+"'表的主键吗？")==true){
			var s2=InsertSql(sSql2);
			if(IsSpace(s2)){
			FCDBedit1.value="";	
			}else{
				alert(s2)
			}
		}else{
			return;
		}
		
	}
}</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcstring.js'></script><script src='../js/fcnumdate.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script defer src='../js/selectdate.js'></script><script src='../../fceformext/js/userfunc.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/Button.css'/><link type='text/css' rel='stylesheet' href='../css/TextStyle.css'/><script >document.styleSheets[0].addRule("fc\\:webgrid","behavior: url(../htc/webgrid.htc)",0);</script><script src='../js/fcwebgrid.js'></script><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../htc/dataset.htc)",0);</script><script src='../js/fcdataset.js'></script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" OtherSave="否" toolbar="不带工具栏" BLONopen="uf_sSql()" contxml="<root><label><id>Label1</id><id>Label2</id></label><listbox><id>SKDBListBox1</id></listbox><button><id>FCButton1</id><id>FCButton2</id><id>FCButton3</id><id>FCButton4</id><id>FCButton5</id><id>FCButton6</id><id>FCButton7</id></button><text><id>FCDBedit1</id></text><grid><id>imgwebgrid1</id></grid><dataset><id>imgdataset1</id></dataset></root>" billtaborder="<root><taborder>SKDBListBox1</taborder><taborder>FCButton1</taborder><taborder>FCButton2</taborder><taborder>FCButton3</taborder><taborder>FCButton4</taborder><taborder>FCButton5</taborder><taborder>FCButton6</taborder><taborder>FCButton7</taborder><taborder>FCDBedit1</taborder><taborder>imgwebgrid1</taborder></root>" dj_sn="data_maint" type="ST" caption="数据库维护" mkbh codeheader="BBB" entertype="修改" poswidth posheight controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0" keyfield window="当前窗口" posleft postop isfile="否" idtype="1"><SPAN id=Label1 style="DISPLAY: block; FONT-WEIGHT: bold; FONT-SIZE: 16px; LEFT: 12px; WIDTH: 124px; COLOR: #0000ff; FONT-FAMILY: 楷体_GB2312; POSITION: absolute; TOP: 37px; HEIGHT: 17px; TEXT-ALIGN: left; TEXT-DECORATION: underline; backgroundColor1: #ffffff; textLeft: undefined; textRight: undefined; textCenter: undefined" onmovestart=moveStart() value="Label1" controltype="label">选择数据库表：</SPAN><SELECT id=SKDBListBox1 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 6px; WIDTH: 155px; FONT-FAMILY: ; POSITION: absolute; TOP: 56px; HEIGHT: 384px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() onchange='bill_onclick("uf_click()")' size=8 controltype="listbox" check="1" tempvalue temptext china sql sqltrans></SELECT><?xml:namespace prefix = fc /><fc:dataset id=imgdataset1 temptable="TMP_IMGDATASET2" opensortno="1" format="<fields><field><fieldname>fdname</fieldname><datatype>字符</datatype><displaylabel>西文字段名</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>colorder</fieldname><datatype>字符</datatype><displaylabel>序列号</displaylabel><size>2</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fdtype</fieldname><datatype>字符</datatype><displaylabel>字段类型</displaylabel><size>20</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fdsize</fieldname><datatype>整数</datatype><displaylabel>字段宽度</displaylabel><size>2</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fddec</fieldname><datatype>整数</datatype><displaylabel>字段精度</displaylabel><size>2</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>isnullable</fieldname><datatype>整数</datatype><displaylabel>允许空</displaylabel><size>4</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><fdname></fdname><colorder></colorder><fdtype></fdtype><fdsize></fdsize><fddec></fddec><isnullable></isnullable></dsid>")' onGetText='bill_ondatasetgettext("<dsid><fdname></fdname><colorder></colorder><fdtype></fdtype><fdsize></fdsize><fddec></fddec><isnullable></isnullable></dsid>")' onSetText='bill_ondatasetsettext("<dsid><fdname></fdname><colorder></colorder><fdtype></fdtype><fdsize></fdsize><fddec></fddec><isnullable></isnullable></dsid>")'></fc:dataset><fc:webgrid id=imgwebgrid1 onkeydown='bill_ongridkeydown("<imgwebgrid1><col></col><col></col><col></col><col></col><col></col></imgwebgrid1>")' ondblclick='bill_ongriddblclick("<imgwebgrid1><col>GridMultiSel(imgwebgrid1,imgdataset1)</col><col>GridMultiSel(imgwebgrid1,imgdataset1)</col><col>GridMultiSel(imgwebgrid1,imgdataset1)</col><col>GridMultiSel(imgwebgrid1,imgdataset1)</col><col>GridMultiSel(imgwebgrid1,imgdataset1)</col></imgwebgrid1>")' onclick='bill_ongridclick("<imgwebgrid1><col></col><col></col><col></col><col></col><col></col></imgwebgrid1>")' dataset="imgdataset1" canselect="是" autoheight="否" autowidth="否" autoappend="否" readonly="否" visible="是" format="<cols><col><fname>fdname</fname><cname>西文字段名</cname><width>50</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>120</columnwidth><align>left</align></col><col><fname>fdtype</fname><cname>字段类型</cname><width>20</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>80</columnwidth><align>left</align></col><col><fname>fdsize</fname><cname>字段宽度</cname><width>2</width><dtype>整数</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>60</columnwidth><align>left</align></col><col><fname>fddec</fname><cname>字段精度</cname><width>2</width><dtype>整数</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>40</columnwidth><align>left</align></col><col><fname>isnullable</fname><cname>允许空</cname><width>4</width><dtype>整数</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>80</columnwidth><align>left</align></col></cols>" width="412" height="368" top="56" left="159">
<TABLE id=t style="TABLE-LAYOUT: fixed; FONT-SIZE: 12px; LEFT: 0px; POSITION: absolute; TOP: 0px; BORDER-COLLAPSE: collapse; BACKGROUND-COLOR: #ffffff" cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR class=fcGridFirstRow style="FONT-SIZE: 12px; HEIGHT: 30px; BACKGROUND-COLOR: #d4d0c8">
<TD></TD></TR></TBODY></TABLE></fc:webgrid><BUTTON id=FCButton1 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 257px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_addField()")'>新增字段</BUTTON><BUTTON id=FCButton2 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 323px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_del()")'>删除字段</BUTTON><BUTTON id=FCButton3 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 389px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_alterField()")'>修改字段</BUTTON><BUTTON id=FCButton4 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 455px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_setPrimaryKey()")'>设置主键</BUTTON><BUTTON id=FCButton5 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 191px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_dropTab()")'>删除表</BUTTON><BUTTON id=FCButton6 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 125px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_createTab()")'>新建表</BUTTON><SPAN id=Label2 style="DISPLAY: block; FONT-WEIGHT: bold; FONT-SIZE: 16px; LEFT: 160px; WIDTH: 92px; COLOR: #0000ff; FONT-FAMILY: 楷体_GB2312; POSITION: absolute; TOP: 37px; HEIGHT: 0px; TEXT-ALIGN: left; TEXT-DECORATION: none; backgroundColor1: #c0c0c0; textLeft: undefined; textRight: undefined; textCenter: undefined" onmovestart=moveStart() value="Label2" controltype="label">主键字段：</SPAN><INPUT type=text id=FCDBedit1 style="BORDER-RIGHT: silver 1px solid; BORDER-TOP: dimgray 2px solid; DISPLAY: block; FONT-SIZE: 12px; LEFT: 249px; BORDER-LEFT: dimgray 2px solid; WIDTH: 337px; BORDER-BOTTOM: silver 1px solid; FONT-FAMILY: ; POSITION: absolute; TOP: 34px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" onmovestart=moveStart() value controltype="text" china CanSelect="false" readOnly="true"></INPUT><BUTTON id=FCButton7 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 521px; WIDTH: 64px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_delUnique()")'>删除主键</BUTTON></DIV></body></html>