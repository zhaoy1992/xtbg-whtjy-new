<HTML xmlns:fc>
	<HEAD>
		<META http-equiv="Content-Type" content="text/html; charset=gb2312">
		<script src="../js/fcpub.js"></script>
		<script src="../js/design.js"></script>
		<script src="../js/fctoolbar.js"></script>
		<script src="../../fceformext/js/usertb.js"></script>
	
		<link rel="stylesheet" type="text/css" href="menu.css">
			<STYLE> .userData{behavior:url(#default#userData);}
	.aFilter{filter:alpha(opacity=80);}
	.over{BORDER-TOP: #D5D5D6 1px solid; BORDER-LEFT: #D5D5D6 1px solid;BORDER-RIGHT:#676869 1px solid;BORDER-BOTTOM: #676869 1px solid;filter:changestrength(strength=800) alpha(opacity=90) dropshadow(color=#8BBCC5,offx=1,offy=1);}
	.down{BORDER-TOP: #676869 1px solid; BORDER-LEFT:  #676869 1px solid; BORDER-RIGHT:#D5D5D6 1px solid;BORDER-BOTTOM: #D5D5D6 1px solid;filter:changestrength(strength=800) alpha(opacity=100,color=#8BBCC5) dropshadow(color=#8BBCC5,offx=1,offy=1);}
	</STYLE>
			<script>

var pubPositionChange = "否";

/**
	将控件添加到页面上
	@date 2004-06-28 liuxr 整理
	@name 要添加的控件的名称
**/
function SetToolBarClass(sTag){
	var curTD=event.srcElement 
	if(curTD.tagName=="IMG"){
		//curTD=curTD.parentNode
		//if(curTD.tagName=="TD"){
			switch (sTag){
				case "onmousedown" : 
					curTD.className="down"
					break
				case "onmouseup" :
						curTD.className="over"
					break					
				case "onmouseout" :
						curTD.className="aFilter"
					break				
				case "onmouseover" :
						curTD.className="over"
					break
			//}
			
		}
		
	}	
}
function tbr1_onmousedown() {
	SetToolBarClass("onmousedown")
}
function tbr1_onmouseup() {
	SetToolBarClass("onmouseup")
}
function tbr1_onmouseout() {
	SetToolBarClass("onmouseout")
}
function tbr1_onmouseover() {
	SetToolBarClass("onmouseover")
}
function Add(name){
	parent.topic.execScript("Addobj('"+name+"')");
}

/**
打开系统表单
*@date 2004-08-23
**/
function opensystemdj(djsn){
	window.open("opendj.htm?djsn="+djsn)
}
/**
//直接运行输入的命令,可用于设置表格背景等功能
**/
function RunCommand() {
	var s1=LoadPubData("historycommand")
	if(isSpace(s1)) s1=""
	var sRet=window.showModalDialog("dsncommand.htm",s1,"center:yes;status:no;scroll:no;dialogHeight:340px;dialogWidth:695px;") 
	if(isSpace(sRet) == false ){
		//parent.topic.execScript("eval("+sRet+")")
		SavePubData("historycommand",sRet)
		parent.topic.execScript(sRet)
		
	}

}

function tohref(djsn) {
  //window.document.location.href = href;
  window.open('rundj.htm?djsn='+djsn)
}
function runsupport() {
	if(fcpubdata.databaseTypeName == "mysql"){
		alert("在mysql数据库下无法使用此功能!")
	}else{
		tohref('support')
	}
}
function showobjlist() {
	if(parent.main1.cols == "15%,85%"){
		parent.main1.cols = "0,100%"
	} else {
		parent.main1.cols = "15%,85%"
	}
}

/**
*检查和维护控件ID的完整性
*@date 2005-04-21
**/
function check_contid() {
	var sRun = "if(TooContXml()){openobjlist();alert('OK!')}"
	parent.topic.execScript(sRun)
}
/**
*执行存储过程来生成fc_fldlist等三张表的内容
<MenuItem Func="runproc()" Text="生成表字段信息" img="../image/chang.gif" />  
*@date 2005-04-23
**/
function runproc() {
	var sRet = InsertSql("exec auto_table_data")
	if(IsSpace(sRet)){
		alert("生成成功!")
	}else{
		alert(sRet)
	}
}


//拖动
function tb_ondrag() {
	event.returnValue = false ;
	//alert(event.srcElement.outerHTML)
	//event.srcElement.outerHTML = "ssssss"
	//event.dataTransfer.setData("Text","ass")
}


function mytest(){
//	parent.topic.SKButton1.style.visibility="hidden"
parent.topic.execScript("CopyToPub(SKbillsheet.outerHTML)")
	//alert(parent.topic.pubDsMain.outerHTML)
}
function test(){
    alert("aa");
}
function openHelp(){
	ShowHelp("index");
	//window.open("../help/index.htm");

}
function window_onload() {
	//cboZoom.selectedIndex = 4 ; //让选中100
	if(fcpubdata.toolbarstyle == "CoolBlue"){
		MenubarDiv.style.cssText = "LEFT:618px;WIDTH:100px;POSITION:absolute;TOP:0px;HEIGHT:35px"
	}else{
		MenubarDiv.style.cssText = "LEFT:579px;WIDTH:100px;POSITION:absolute;TOP:0px;HEIGHT:40px"
	}
	MenubarDiv.style.display = ""
	//table1.outerHTML += str;
}
/**
*用combo设置zoom
*@date 2005-08-22
**/
function cboZoom_onchange() {
	var sV = cboZoom.options(cboZoom.selectedIndex ).text ;
	var n = parseInt(sV)/100 ;
	if(n == 1) {
		parent.topic.middlediv.style.cssText = "overflow:auto" ;
	}else{
		parent.topic.middlediv.style.cssText = "overflow:auto;width:100%;height:100%;zoom:"+n ;
	}
}
try{
	RegButton() ;
}catch(e){};

//加工具栏
var tbCss = "" ;
tbCss = parent.Request.QueryString("tbcss").toString();
if(tbCss != "undefined" && tbCss != "" ){
	fcpubdata.toolbarstyle = tbCss ;
}
//控制工具栏的个数
var tbtype = "";
tbtype = parent.Request.QueryString("tbtype").toString();
if(tbtype=="undefined"){
	tbtype="0";
}
switch(tbtype){
	case "1":   //标准
		fcpubdata.toolbar = "newdj,opendj,opendjfile,billtype,djpreview,directrun,save,saveas,|,cut,copy,paste,undo,redo,|,align,focus,front,behind,form,|,userfunction,execute,showlist,setPosition,|,menu,eformhelp,cbozoom,br,button,label,img,div,shape,|,tab,tree,a,spin,checkboxlist,radiolist,|,dataset,grid,htmltable,formattab,|,text,checkbox,radio,listbox,dropdownlist,combobox,textarea,dbimg,|,chart,upload,excel,word" ;
		break ;
	case "2":   //简单
		fcpubdata.toolbar = "newdj,opendj,djpreview,save,|,setPosition,eformhelp,br,button,label,text,checkbox,radio,combobox" ;
		break ;
	case "4":   //自定义工具栏
		fcpubdata.toolbar = "newdj,opendj,djpreview,save,|,setPosition,eformhelp,br,button,label,text,checkbox,radio,combobox,mytest1" ;
		break ;
	case "0":
		fcpubdata.toolbar = "cbozoom";			
		break;
}

			</script>
	</HEAD>
	<body onload="window_onload()" >
		<div id="div1"></div>
		<div id="MenubarDiv" ></div>
		<!--<WebMenu DataSource="MenuCode.value" class="WebMenu" id="Menu2" Width="100" Effect="3" MenuType="0"
			Container="MenubarDiv"></WebMenu>
		<textarea rows="17" id="MenuCode" cols="73" style="DISPLAY:none" >				
				&lt;Root&gt;
				&lt;MenuItem  hasSub="1" subWidth="10" &gt;
					&lt;MenuItem Func=""   Text="常用工具菜单"  img="" hasSub="1" subWidth="180"&gt;
							&lt;MenuItem Func="window.open('../common/example.htm')" Text="进入示例中心" img="../images/ef_design_shuxing.gif" /&gt;
							&lt;MenuItem Func="tohref('data_maint')" Text="数据库维护" img="../images/ef_design_function.gif" /&gt;  
							&lt;MenuItem Func="tohref('data_fldlist')" Text="传递表结构数据" img="../images/ef_design_function.gif" /&gt;  
							&lt;MenuItem Func="runsupport()" Text="维护字段中文名" img="../images/ef_design_function.gif" /&gt;  
							&lt;MenuItem Func="tohref('fcs_FieldEdit')" Text="维护字段输入方式" img="../images/ef_design_function.gif" /&gt;  
							&lt;MenuItem Func="tohref('falist')" Text="设置检索方案" img="../images/ef_tb_find.gif" /&gt;  
							&lt;MenuItem Func="tohref('djtohtml')" Text="生成正式文件" img="../images/ef_design_save.gif" /&gt;
							&lt;MenuItem Func="tohref('bill_export')" Text="导出表单到文件" img="../images/ef_design_saveas.gif" /&gt;
							&lt;MenuItem Func="check_contid()" Text="维护控件ID" img="../images/ef_design_function.gif" /&gt;  
					&lt;/MenuItem&gt;	
				      
				&lt;/MenuItem&gt;
				&lt;/Root&gt;

		</textarea>-->
		<form id="oForm" >
			<input Class="userData" style="DISPLAY: none" ID="oInput" NAME="oInput">
		</form>
		<script>
		if(parent.Request.QueryString("ebuse").toString() == "yes"){
			//parent.document.title ="aasss";
			fcpubdata.toolbar = "ebiaoform,|,cut,copy,paste,undo,redo,|,align,focus,front,behind,|,userfunction,userfunction1,addhtml,execute,showlist,setPosition,|,cbozoom,br,ebiaobind,ebshow,|,button,label,img,div,shape,|,tab,a,spin,|,htmltable,formattab,|,text,checkbox,radio,listbox,combobox,dropdownlist,textarea";
		}
		AddToolbarButton();
		</script>
	</body>
</HTML>
