<html> <head> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var O="INSERT";var J=lang["DlgComInsert"];var A;var dK;var aE;var aw="http://";var eK="";var bE="0";var ay="";var eO="";var aH="";var R="";var T="";var by="";var bC="";var bB="";var bc="file";var aA=((parseFloat(config.AllowImageSize)>0)?true:false);var kx=(((config.SYWZFlag=="2")||(config.SYTPFlag=="2"))?true:false);Q=dialogArguments.eWebEditor.document.selection.createRange();aE=dialogArguments.eWebEditor.document.selection.type;if(aE=="Control"){if(Q.item(0).tagName=="IMG"){O="MODI";J=lang["DlgComModify"];bc="url";A=Q.item(0);aw=A.getAttribute("src",2);eK=A.alt;bE=A.border;ay=A.style.borderColor;eO=A.style.filter;aH=A.align;R=A.width;T=A.height;by=A.vspace;bC=A.hspace;}}document.write("<title>"+lang["DlgImg"]+"("+J+")</title>");function I(){lang.as(document);ap(d_filter,eO);ap(d_align,aH.toLowerCase());if(!aA){bc="url";}aq(bc);d_fromurl.value=aw;d_alt.value=eK;d_border.value=bE;d_bordercolor.value=ay;s_bordercolor.style.backgroundColor=ay;d_width.value=R;d_height.value=T;d_vspace.value=by;d_hspace.value=bC;bW();at();};function aq(af){if(af=="url"){d_fromurl.disabled=false;if(config.AllowBrowse=="1"){d_browse.disabled=false;}d_checkfromurl.checked=true;if(aA){d_checkfromfile.checked=false;document.myuploadform.uploadfile.disabled=true;}}else{d_checkfromurl.checked=false;document.myuploadform.uploadfile.disabled=false;d_checkfromfile.checked=true;d_fromurl.disabled=true;if(config.AllowBrowse=="1"){d_browse.disabled=true;}}};function UploadError(aJ){bZ();aq('file');divProcessing.style.display="none";try{aF(document.myuploadform.uploadfile,eA(aJ,config.AllowImageExt,config.AllowImageSize));}catch(e){}};function UploadSaved(bL,fX){d_fromurl.value=bL;bB=fX;if(config.SLTMode=="0"&&config.SLTFlag=="2"){bB=bL;}aR();};function aR(){aw=d_fromurl.value;eK=d_alt.value;bE=d_border.value;ay=d_bordercolor.value;eO=d_filter.options[d_filter.selectedIndex].value;aH=d_align.value;R=d_width.value;T=d_height.value;by=d_vspace.value;bC=d_hspace.value;if(O=="MODI"){if(bB){A.src=bB;}else{A.src=aw;}A.alt=eK;A.border=bE;A.style.borderColor=ay;A.style.filter=eO;A.align=aH;A.width=R;A.height=T;A.style.width=R;A.style.height=T;A.vspace=by;A.hspace=bC;if(bB){Q.execCommand("CreateLink",false,aw);var aC=Q(0).parentNode;aC.target="_blank";}}else{var an='';if(eO!=""){an=an+'filter:'+eO+';';}if(ay!=""){an=an+'border-color:'+ay+';';}if(an!=""){an=' style="'+an+'"';}if(bB){an='<img id=eWebEditor_TempElement_Img src="'+bB+'"'+an;}else{an='<img id=eWebEditor_TempElement_Img src="'+aw+'"'+an;}if(bE!=""){an=an+' border="'+bE+'"';}if(eK!=""){an=an+' alt="'+eK+'"';}if(aH!=""){an=an+' align="'+aH+'"';}if(R!=""){an=an+' width="'+R+'"';}if(T!=""){an=an+' height="'+T+'"';}if(by!=""){an=an+' vspace="'+by+'"';}if(bC!=""){an=an+' hspace="'+bC+'"';}an=an+'>';if(bB){an='<a id=eWebEditor_TempElement_Img_Href href="'+aw+'" target="_blank">'+an+'</a>';}dialogArguments.insertHTML(an);var au=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Img");if(bB){au.src=bB;var ig=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Img_Href");ig.setAttribute("href",aw);ig.removeAttribute("id");}else{au.src=aw;}au.removeAttribute("id");}window.returnValue=null;window.close();};var gv="";function ok(){d_border.value=bn(d_border.value);d_width.value=bn(d_width.value);d_height.value=bn(d_height.value);d_vspace.value=bn(d_vspace.value);d_hspace.value=bn(d_hspace.value);if(!cr(d_bordercolor.value)){aF(d_bordercolor,lang["DlgImgErrBorColor"]);return false;}if(d_checkfromurl.checked){aR();}else{if(!da(document.myuploadform.uploadfile.value,config.AllowImageExt)){UploadError("ext");return false;}ca();divProcessing.style.display="";if(kx){if(gv==""){gv=document.myuploadform.action;}if(d_syflag.checked){document.myuploadform.action=gv+"&syflag=1";}else{document.myuploadform.action=gv;}}document.myuploadform.submit();}};function ca(){d_checkfromfile.disabled=true;d_checkfromurl.disabled=true;d_fromurl.disabled=true;if(config.AllowBrowse=="1"){d_browse.disabled=true;}d_alt.disabled=true;d_border.disabled=true;d_bordercolor.disabled=true;d_filter.disabled=true;d_align.disabled=true;d_width.disabled=true;d_height.disabled=true;d_vspace.disabled=true;d_hspace.disabled=true;Ok.disabled=true;};function bZ(){d_checkfromfile.disabled=false;d_checkfromurl.disabled=false;d_fromurl.disabled=false;if(config.AllowBrowse=="1"){d_browse.disabled=false;}d_alt.disabled=false;d_border.disabled=false;d_bordercolor.disabled=false;d_filter.disabled=false;d_align.disabled=false;d_width.disabled=false;d_height.disabled=false;d_vspace.disabled=false;d_hspace.disabled=false;Ok.disabled=false;};function bW(){var url;if(d_checkfromurl.checked){url=d_fromurl.value;if(config.BaseHref!=""){url=config.BaseHref+url;}}else{url=document.myuploadform.uploadfile.value;}if(url.lastIndexOf(".")<=0){jM();return;}var ko=false;if((aA)&&(myBrowser.IsIE7||myBrowser.IsIE8)){if(d_checkfromfile.checked){ko=true;}}if(url){if(ko){om(url);}else{imgPreview.src=url;}}else{tdPreview.innerHTML="";}};function os(){var w=imgPreview.width;var h=imgPreview.height;if(imgPreview.src){var bw=tdPreview.offsetWidth;var bh=tdPreview.offsetHeight;var sw,bq;if((w>bw)||(h>bh)){var nw=bw/w;var de=bh/h;if(nw>de){bq=bh;sw=w*de;}else{sw=bw;bq=h*nw;}}tdPreview.innerHTML="<img border=0 src='"+imgPreview.src+"' width='"+sw+"' height='"+bq+"' style=\"filter:"+d_filter.value+"\">";tdPreviewSize.innerHTML=w+" * "+h;jI(w,h);}};function jM(){tdPreview.innerHTML="";tdPreviewSize.innerHTML="";};function om(url){var bw=tdPreview.offsetWidth;var bh=tdPreview.offsetHeight;tdPreview.innerHTML="<div id=imgPreviewDiv style=\"filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image) "+d_filter.value+";WIDTH:10px; HEIGHT:10px;\"></div>";imgPreviewDiv.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=url;var w=imgPreviewDiv.offsetWidth;var h=imgPreviewDiv.offsetHeight;var sw,bq;if((w>bw)||(h>bh)){var nw=bw/w;var de=bh/h;if(nw>de){bq=bh;sw=w*de;}else{sw=bw;bq=h*nw;}}else{sw=w;bq=h;}imgPreviewDiv.style.width=sw;imgPreviewDiv.style.height=bq;imgPreviewDiv.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod='scale';tdPreviewSize.innerHTML=w+" * "+h;jI(w,h);};function jI(w,h){if(config.SLTFlag!="2"){return;}var fU=parseInt(config.SLTMinSize);var dg=parseInt(config.SLTOkSize);var tw,th;switch(config.SLTCheckFlag){case "0":if(w<=fU){return;}tw=dg;th=parseInt(h*(dg/w));break;case "1":if(h<=fU){return;}tw=parseInt(w*(dg/h));th=dg;break;case "2":if(w<=fU&&h<=fU){return;}if(w>h){tw=dg;th=parseInt(h*(dg/w));}else{tw=parseInt(w*(dg/h));th=dg;}break;}d_width.value=tw+"";d_height.value=th+"";}</script> <BODY onload="I()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table border=0 cellpadding=0 cellspacing=5 align=center> <tr valign=top><td width="60%"> <table border=0 cellpadding=0 cellspacing=0 align=center width="100%"> <tr> <td> <fieldset> <legend><span lang=DlgImgSource></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=0 width="300px"><tr><td></td></tr></table> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <script type="text/javascript">
if(aA){document.write("<tr>");document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"aq('file')\"><label for=d_checkfromfile>"+lang["DlgFromFile"]+"</label>:</td>");document.write("<td noWrap width=\"80%\">");document.write(ez("image"));document.write("</td>");document.write("</tr>");}</script> <tr> <td noWrap width="20%"><input type=radio id="d_checkfromurl" value="1" onclick="aq('url')"><label for=d_checkfromurl><span lang=DlgFromUrl></span></label>:</td> <td noWrap width="80%"> <script type="text/javascript">
if(config.AllowBrowse=="1"){document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:100%' size=20 value='' onpropertychange=\"if (event.propertyName=='value'){bW()}\"></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"eG('image','fromurl')\" value='"+lang["DlgBtnBrowse"]+"' align=absmiddle></td></tr></table>");}else{document.write("<input type=text id='d_fromurl' style='width:100%' size=30 value='' onpropertychange=\"if (event.propertyName=='value'){bW()}\">");}</script> </td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <fieldset> <legend><span lang=DlgImgEffect></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <tr> <td noWrap width="20%"><span lang=DlgImgAlt></span>:</td> <td noWrap width="80%" colspan=4><input type=text id=d_alt size=10 value="" style="width:100%"></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgBorder></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_border size=10 value="" ONKEYPRESS="event.returnValue=aD();"></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgBorderColor></span>:</td> <td noWrap width="29%"><input style="width:62px" type=text id=d_bordercolor size=7 value=""><img border=0 src="../sysimage/rect.gif" width=18 style="cursor:hand" id=s_bordercolor onclick="cq('bordercolor')" align=absmiddle></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgSpecEffect></span>:</td> <td noWrap width="29%"> <select id=d_filter size=1 style="width:80px" onchange="bW()"> <option value='' selected lang=DlgComNone></option> <option value='Alpha(Opacity=50)' lang=DlgImgAlpha1></option> <option value='Alpha(Opacity=0, FinishOpacity=100, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=140)' lang=DlgImgAlpha2></option> <option value='Alpha(Opacity=10, FinishOpacity=100, Style=2, StartX=30, StartY=30, FinishX=200, FinishY=200)' lang=DlgImgAlpha3></option> <option value='blur(add=1,direction=14,strength=15)' lang=DlgImgBlur1></option> <option value='blur(add=true,direction=45,strength=30)' lang=DlgImgBlur2></option> <option value='Wave(Add=0, Freq=60, LightStrength=1, Phase=0, Strength=3)' lang=DlgImgWave></option> <option value='gray' lang=DlgImgGray></option> <option value='Chroma(Color=#FFFFFF)' lang=DlgImgChroma></option> <option value='DropShadow(Color=#999999, OffX=7, OffY=4, Positive=1)' lang=DlgImgDropShadow></option> <option value='Shadow(Color=#999999, Direction=45)' lang=DlgImgShadow></option> <option value='Glow(Color=#ff9900, Strength=5)' lang=DlgImgGlow></option> <option value='flipv' lang=DlgImgFlipv></option> <option value='fliph' lang=DlgImgFliph></option> <option value='grays' lang=DlgImgGrays></option> <option value='xray' lang=DlgImgXray></option> <option value='invert' lang=DlgImgInvert></option> </select> </td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgAlign></span>:</td> <td noWrap width="29%"> <select id=d_align size=1 style="width:80px"> <option value='' selected lang=DlgComDefault></option> <option value='left' lang=DlgAlignLeft></option> <option value='right' lang=DlgAlignRight></option> <option value='top' lang=DlgAlignTop></option> <option value='middle' lang=DlgAlignMiddle></option> <option value='bottom' lang=DlgAlignBottom></option> <option value='absmiddle' lang=DlgAlignAbsmiddle></option> <option value='absbottom' lang=DlgAlignAbsbottom></option> <option value='baseline' lang=DlgAlignBaseline></option> <option value='texttop' lang=DlgAlignTexttop></option> </select> </td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgWidth></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_width size=10 value="" ONKEYPRESS="event.returnValue=aD();" maxlength=4></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgHeight></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_height size=10 value="" ONKEYPRESS="event.returnValue=aD();" maxlength=4></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgVSpace></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_vspace size=10 value="" ONKEYPRESS="event.returnValue=aD();" maxlength=2></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgHSpace></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_hspace size=10 value="" ONKEYPRESS="event.returnValue=aD();" maxlength=2></td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> </table> </td><td width="40%" height="100%"> <fieldset style="height:100%"> <legend><span lang=DlgImgPreview></span></legend> <table border=0 cellpadding=0 cellspacing=5 width="200" height="200" valign=top> <tr><td colspan=2 bgcolor=#FFFFFF align=center valign=middle id=tdPreview height="100%"> </td></tr> <tr><td id=tdPreviewSize></td><td align=right><input type=button id=mV onclick="bW()" lang=DlgImgPreview></td></tr> </table> </fieldset> </td></tr> <tr> <td noWrap> <script type="text/javascript">
if(kx){document.write("<input type=checkbox id=d_syflag value='1'><label for=d_syflag><span lang=DlgImgSYFlag></span></label>");}</script> </td> <td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel></td> </tr> </table> </td></tr></table> <div id=divProcessing style="width:200px;height:30px;position:absolute;left:70px;top:100px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgComUploading></span></font></marquee></td></tr></table> </div> <img id=imgPreview src='' border=0 style="visibility:hidden" onload="os()" onerror="jM()"> </body> </html>