<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var O=URLParams["action"];var dh="";if(O=="paste"){dh="("+lang["DlgWordPaste"]+")";}document.write("<title>"+lang["DlgExcel"]+dh+"</title>");function ok(){if(!bY(true)){return;}var bp="";var kn=0;if(O!="paste"){if(d_sheet.length<=0){alert(lang["DlgExcelInvalidFile"]);return;}bp=d_file.value;kn=parseInt(d_sheet.options[d_sheet.selectedIndex].value);}var bm="";if(d_imgjpg.checked){bm="jpg";}else if(d_imggif.checked){bm="gif";}else if(d_imgpng.checked){bm="png";}var aj="";aj+="mode:"+(d_modehtml.checked?"html":"img")+";";aj+="imgtype:"+bm+";";aj+="optimizemode:"+(d_opt2.checked?"2":"1")+";";aj+="opt1vml:"+(d_opt1vml.checked?"1":"0")+";";aj+="opt1space:"+(d_opt1space.checked?"1":"0")+";";aj+="opt1table:"+(d_opt1table.checked?"1":"0")+";";aj+="opt1overflow:"+(d_opt1overflow.checked?"1":"0")+";";aj+="opt2image:"+(d_opt2image.checked?"1":"0")+";";aj+="opt2space:"+(d_opt2space.checked?"1":"0")+";";aj+="opt2table:"+(d_opt2table.checked?"1":"0")+";";divProcessing.style.display="";if(O!="paste"){eWebEditorActiveX.ImportExcelSheet(bp,kn,aj);}else{eWebEditorActiveX.PasteExcel(aj);}window.setTimeout("di()",100);};function di(){if(eWebEditorActiveX.Status!="ok"){window.setTimeout("di()",100);return;}if(cO()){divProcessing.style.display="none";return;}var dH=eWebEditorActiveX.Style;if(d_opt2.checked){dH="";}var cd=eWebEditorActiveX.Body;var cv=eWebEditorActiveX.OriginalFiles;var dm=eWebEditorActiveX.SavedFiles;if(cv){var bP=cv.split("|");var aQ=dm.split("|");for(var i=0;i<bP.length;i++){if(aQ[i]){var dJ=bP[i];var dP=aQ[i].substr(aQ[i].lastIndexOf("/")+1);var dQ=aQ[i];dialogArguments.addUploadFile(dJ,dP,dQ);}}}if(d_pos.checked){dialogArguments.setHTML(dH+cd,true);}else{var bT="<SPAN id=eWebEditorTempInsertTag></SPAN>";dialogArguments.insertHTML(bT);var bU=dialogArguments.getHTML();var n1=bU.indexOf(bT);var bt=dH+bU.substring(0,n1)+cd+bU.substr(n1+bT.length);dialogArguments.setHTML(bt,true);}eWebEditorActiveX=null;divProcessing.style.display="none";window.returnValue=null;window.close();};var fL="";function je(){if(!bY(true)){return;}var bp=bs(d_file.value);if((fL!=bp)){d_sheet.options.length=0;fL="";}if(bp==""){return;}if(bp.indexOf(":")<0){return;}if((fL!="")&&(fL==bp)){return;}if(!da(bp,"xls|xlsx")){return;}var oq=eWebEditorActiveX.GetExcelWorkSheetName(bp);if(cO()){return;}d_sheet.options[0]=new Option(lang["DlgExcelSheetAll"],"0");var jr=oq.split("\n");for(var i=0;i<jr.length;i++){d_sheet.options[d_sheet.options.length]=new Option(jr[i],i+1);}fL=bp;eWebEditorActiveX=null;};function dT(index){var oD,gF;for(var i=1;i<=2;i++){oD=document.getElementById("group_opt"+i);gF=oD.getElementsByTagName("INPUT");for(var j=0;j<gF.length;j++){if(index==i){gF[j].disabled=false;}else{gF[j].disabled=true;}}gF=oD.getElementsByTagName("SPAN");for(var j=0;j<gF.length;j++){if(index==i){gF[j].disabled=false;}else{gF[j].disabled=true;}}}};function fK(flag){if(flag==1){tab_modehtml.style.display="";tab_modeimg.style.display="none";}else{if(tab_modehtml.style.display=="none"){return;}tab_modeimg.style.height=tab_modehtml.offsetHeight;tab_modeimg.style.width=tab_modehtml.offsetWidth;tab_modehtml.style.display="none";tab_modeimg.style.display="";}};function I(){lang.as(document);at();d_opt1.checked=true;dT(1);if(O=="paste"){document.getElementById("d_pos").checked=false;}fz();};function fz(){var el=document.getElementById("divProcessing");el.style.left=(tabDialogSize.offsetWidth+6-parseInt(el.style.width))/2+"px";el.style.top=(tabDialogSize.offsetHeight-parseInt(el.style.height))/2+"px";}</script> <BODY onload="I()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <script type="text/javascript">
if(O!="paste"){document.write("<tr>");document.write("	<td>");document.write("	<fieldset>");document.write("	<legend><span lang=DlgExcelLegend></span>:</legend>");document.write("	<table border=0 cellpadding=5 cellspacing=0 width='100%'>");document.write("	<tr><td>");document.write("		<table border=0 cellpadding=0 cellspacing=2 width='100%'>");document.write("		<tr>");document.write("			<td noWrap><span lang=DlgExcelFile></span>:</td>");document.write("			<td noWrap width='100%'><input type=file id='d_file' size=30 style='width:100%' onchange='je()' onkeyup='je()'></td>");document.write("		</tr>");document.write("		<tr>");document.write("			<td noWrap><span lang=DlgExcelSheet></span>:</td>");document.write("			<td noWrap><select id='d_sheet' size=1 style='width:100%'></select></td>");document.write("		</tr>");document.write("		</table>");document.write("	</td></tr>");document.write("	</table>");document.write("	</fieldset>");document.write("	</td>");document.write("</tr>");document.write("<tr><td height=5></td></tr>");}</script> <tr> <td> <fieldset> <legend><span lang=DlgExcelOptimize></span>: <input type=radio id=d_modehtml name=g_mode checked onclick="fK(1)"><label for=d_modehtml><span lang=DlgWordModeHTML></span></label>&nbsp;<input type=radio id=d_modeimg name=g_mode onclick="fK(2)"><label for=d_modeimg><span lang=DlgWordModeIMG></span></label></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=3 id=tab_modehtml> <tr><td colspan=5 noWrap><input type=radio name="d_optimize" id="d_opt1" checked onclick="dT(1)"><label for=d_opt1><span lang=DlgExcelOpt1></span></label></td></tr> <tr id=group_opt1> <td>&nbsp;&nbsp;&nbsp; </td> <td noWrap><input type=checkbox id=d_opt1vml><label for=d_opt1vml><span lang=DlgExcelOpt1VML></span></label></td> <td noWrap><input type=checkbox id=d_opt1space><label for=d_opt1space><span lang=DlgExcelOpt1Space></span></label></td> <td noWrap><input type=checkbox id=d_opt1table><label for=d_opt1table><span lang=DlgExcelOpt1Table></span></label></td> <td noWrap><input type=checkbox id=d_opt1overflow><label for=d_opt1overflow><span lang=DlgExcelOpt1Overflow></span></label></td> </tr> <tr><td colspan=5 noWrap><input type=radio name="d_optimize" id="d_opt2" onclick="dT(2)"><label for=d_opt2><span lang=DlgExcelOpt2></span></label></td></tr> <tr id=group_opt2> <td>&nbsp; </td> <td noWrap><input type=checkbox id=d_opt2image checked><label for=d_opt2image><span lang=DlgExcelOpt2Image></span></label></td> <td noWrap><input type=checkbox id=d_opt2space><label for=d_opt2space><span lang=DlgExcelOpt2Space></span></label></td> <td noWrap><input type=checkbox id=d_opt2table checked><label for=d_opt2table><span lang=DlgExcelOpt2Table></span></label></td> <td></td> </tr> </table> <table border=0 cellpadding=0 cellspacing=3 id=tab_modeimg style="display:none"> <tr> <td noWrap><span lang=DlgWordImgType></span>: <input type=radio id=d_imggif name=d_imgtype checked><label for=d_imggif>GIF</label> <input type=radio id=d_imgjpg name=d_imgtype><label for=d_imgjpg>JPG</label> <input type=radio id=d_imgpng name=d_imgtype><label for=d_imgpng>PNG</label></td> </tr> <tr><td><span lang=DlgWordImgAlt></span></td></tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 width="100%"> <tr> <td noWrap><input type=checkbox id=d_pos checked><label for=d_pos><span lang=DlgComInsertReplace></span></label></td> <td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel> </tr> </table> </td> </tr> </table> </td></tr></table> <div id=divProcessing style="width:200px;height:30px;position:absolute;left:60px;top:85px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5 align=center><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgExcelImporting></span></font></marquee></td></tr></table> </div> </body> </html> 